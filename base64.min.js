"use strict";
/*!
* Base64 performs several functions:
* Compress a string to base64, Diffie Hellman Merkle key exchange,
* SHA256 hash, and generate high entropy random numbers.
* Generated public Keys are numeric and 300 digits in length (~1000 bit equivelent).
*
* Last Modified: November 26, 2021
* Copyright (C) 2021 Graeme Goodkey github.com/ggoodkey
* All rights reserved
*
* Released free of charge for inclusion in your own applications, as is or as modified by you.
* DISTRIBUTED "AS IS", WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND.
*
* Converting to Base 64 is based on Vassilis Petroulias' base64v1_0.js
* http://jsbase64.codeplex.com/
*
* Compression is based on Sam Hocevar's lz-string-1.3.3.js
* http://pieroxy.net/blog/pages/lz-string/index.html
*
* Handling big integers is a subset of BigInteger.js by peterolson
* https://www.npmjs.com/package/big-integer/
*
*/var Base64=function(){var b64={Version:1.2},charset="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",hexAlf="00,01,02,03,04,05,06,07,08,09,0a,0b,0c,0d,0e,0f,10,11,12,13,14,15,16,17,18,19,1a,1b,1c,1d,1e,1f,20,21,22,23,24,25,26,27,28,29,2a,2b,2c,2d,2e,2f,30,31,32,33,34,35,36,37,38,39,3a,3b,3c,3d,3e,3f,40,41,42,43,44,45,46,47,48,49,4a,4b,4c,4d,4e,4f,50,51,52,53,54,55,56,57,58,59,5a,5b,5c,5d,5e,5f,60,61,62,63,64,65,66,67,68,69,6a,6b,6c,6d,6e,6f,70,71,72,73,74,75,76,77,78,79,7a,7b,7c,7d,7e,7f,80,81,82,83,84,85,86,87,88,89,8a,8b,8c,8d,8e,8f,90,91,92,93,94,95,96,97,98,99,9a,9b,9c,9d,9e,9f,a0,a1,a2,a3,a4,a5,a6,a7,a8,a9,aa,ab,ac,ad,ae,af,b0,b1,b2,b3,b4,b5,b6,b7,b8,b9,ba,bb,bc,bd,be,bf,c0,c1,c2,c3,c4,c5,c6,c7,c8,c9,ca,cb,cc,cd,ce,cf,d0,d1,d2,d3,d4,d5,d6,d7,d8,d9,da,db,dc,dd,de,df,e0,e1,e2,e3,e4,e5,e6,e7,e8,e9,ea,eb,ec,ed,ee,ef,f0,f1,f2,f3,f4,f5,f6,f7,f8,f9,fa,fb,fc,fd,fe,ff".split(","),prime="319705304701141539155720137200974664666792526059405792539680974929469783512821793995613718943171723765238853752439032835985158829038528214925658918372196742089464683960239919950882355844766055365179937610326127675178857306260955550407044463370239890187189750909036833976197804646589380690779463976173";function toHex(arr){for(var hex="",i=0,len=arr.length;i<len;i++)hex+=hexAlf[arr[i]];return hex}function convertTo(input){if(null===input)return"";var output="",orig=input,chr1,chr2,chr3,enc1,enc2,enc3,enc4,i,value,context_dictionary={},context_dictionaryToCreate={},context_c="",context_wc="",context_w="",context_enlargeIn=2,context_dictSize=3,context_numBits=2,context_data_string="",context_data_val=0,context_data_position=0,ii,f=String.fromCharCode;for(ii=0;ii<input.length;ii+=1)if(context_c=input.charAt(ii),Object.prototype.hasOwnProperty.call(context_dictionary,context_c)||(context_dictionary[context_c]=context_dictSize++,context_dictionaryToCreate[context_c]=!0),context_wc=context_w+context_c,Object.prototype.hasOwnProperty.call(context_dictionary,context_wc))context_w=context_wc;else{if(Object.prototype.hasOwnProperty.call(context_dictionaryToCreate,context_w)){if(context_w.charCodeAt(0)<256){for(i=0;i<context_numBits;i++)context_data_val<<=1,15===context_data_position?(context_data_position=0,context_data_string+=f(context_data_val),context_data_val=0):context_data_position++;for(value=context_w.charCodeAt(0),i=0;i<8;i++)context_data_val=context_data_val<<1|1&value,15===context_data_position?(context_data_position=0,context_data_string+=f(context_data_val),context_data_val=0):context_data_position++,value>>=1}else{for(value=1,i=0;i<context_numBits;i++)context_data_val=context_data_val<<1|value,15===context_data_position?(context_data_position=0,context_data_string+=f(context_data_val),context_data_val=0):context_data_position++,value=0;for(value=context_w.charCodeAt(0),i=0;i<16;i++)context_data_val=context_data_val<<1|1&value,15===context_data_position?(context_data_position=0,context_data_string+=f(context_data_val),context_data_val=0):context_data_position++,value>>=1}0===--context_enlargeIn&&(context_enlargeIn=Math.pow(2,context_numBits),context_numBits++),delete context_dictionaryToCreate[context_w]}else for(value=context_dictionary[context_w],i=0;i<context_numBits;i++)context_data_val=context_data_val<<1|1&value,15===context_data_position?(context_data_position=0,context_data_string+=f(context_data_val),context_data_val=0):context_data_position++,value>>=1;0===--context_enlargeIn&&(context_enlargeIn=Math.pow(2,context_numBits),context_numBits++),context_dictionary[context_wc]=context_dictSize++,context_w=String(context_c)}if(""!==context_w){if(Object.prototype.hasOwnProperty.call(context_dictionaryToCreate,context_w)){if(context_w.charCodeAt(0)<256){for(i=0;i<context_numBits;i++)context_data_val<<=1,15===context_data_position?(context_data_position=0,context_data_string+=f(context_data_val),context_data_val=0):context_data_position++;for(value=context_w.charCodeAt(0),i=0;i<8;i++)context_data_val=context_data_val<<1|1&value,15===context_data_position?(context_data_position=0,context_data_string+=f(context_data_val),context_data_val=0):context_data_position++,value>>=1}else{for(value=1,i=0;i<context_numBits;i++)context_data_val=context_data_val<<1|value,15===context_data_position?(context_data_position=0,context_data_string+=f(context_data_val),context_data_val=0):context_data_position++,value=0;for(value=context_w.charCodeAt(0),i=0;i<16;i++)context_data_val=context_data_val<<1|1&value,15===context_data_position?(context_data_position=0,context_data_string+=f(context_data_val),context_data_val=0):context_data_position++,value>>=1}0===--context_enlargeIn&&(context_enlargeIn=Math.pow(2,context_numBits),context_numBits++),delete context_dictionaryToCreate[context_w]}else for(value=context_dictionary[context_w],i=0;i<context_numBits;i++)context_data_val=context_data_val<<1|1&value,15===context_data_position?(context_data_position=0,context_data_string+=f(context_data_val),context_data_val=0):context_data_position++,value>>=1;0===--context_enlargeIn&&(context_enlargeIn=Math.pow(2,context_numBits),context_numBits++)}for(value=2,i=0;i<context_numBits;i++)context_data_val=context_data_val<<1|1&value,15===context_data_position?(context_data_position=0,context_data_string+=f(context_data_val),context_data_val=0):context_data_position++,value>>=1;for(;;){if(context_data_val<<=1,15===context_data_position){context_data_string+=f(context_data_val);break}context_data_position++}function toBase64(input){for(var i=0;i<2*input.length;)i%2==0?(chr1=input.charCodeAt(i/2)>>8,chr2=255&input.charCodeAt(i/2),chr3=i/2+1<input.length?input.charCodeAt(i/2+1)>>8:NaN):(chr1=255&input.charCodeAt((i-1)/2),(i+1)/2<input.length?(chr2=input.charCodeAt((i+1)/2)>>8,chr3=255&input.charCodeAt((i+1)/2)):chr2=chr3=NaN),i+=3,enc1=chr1>>2,enc2=(3&chr1)<<4|chr2>>4,enc3=(15&chr2)<<2|chr3>>6,enc4=63&chr3,isNaN(chr2)?enc3=enc4=64:isNaN(chr3)&&(enc4=64),output=output+charset.charAt(enc1)+charset.charAt(enc2)+charset.charAt(enc3)+charset.charAt(enc4);return output}var compressed=toBase64("l"+context_data_string);return orig=toBase64("n"+orig),compressed.length>orig.length&&(compressed=orig),"b"+compressed}function revertFrom(input){if(null===input)return console.log("Decompression error1: Input is null"),"";if(!/^b/.test(input))return null;input=input.replace(/^b/,"");var output="",ol=0,output_=0,chr1,chr2,chr3,enc1,enc2,enc3,enc4,i=0,f=String.fromCharCode;for(input=input.replace(/[^A-Za-z0-9\+\/\=]/g,"");i<input.length;)chr1=(enc1=charset.indexOf(input.charAt(i++)))<<2|(enc2=charset.indexOf(input.charAt(i++)))>>4,chr2=(15&enc2)<<4|(enc3=charset.indexOf(input.charAt(i++)))>>2,chr3=(3&enc3)<<6|(enc4=charset.indexOf(input.charAt(i++))),ol%2==0?(output_=chr1<<8,64!==enc3&&(output+=f(output_|chr2)),64!==enc4&&(output_=chr3<<8)):(output+=f(output_|chr1),64!==enc3&&(output_=chr2<<8),64!==enc4&&(output+=f(output_|chr3))),ol+=3;if(ol=null,output_=null,chr1=null,chr2=null,chr3=null,enc1=null,enc2=null,enc3=null,enc4=null,!/^l/.test(output))return output.replace(/^n/,"");var compressed=output.replace(/^l/,"");if(output=null,null===compressed)return console.log("Decompression error2: Reverted from Base64 value is null"),null;if(""===compressed)return console.log('Decompression error3: Reverted from Base64 value is "" (Empty string)'),null;for(var dictionary=[0,1,2,3],enlargeIn=4,dictSize=4,numBits=3,entry="",result="",w,bits=0,resb,maxpower=4,power=1,c,data={string:compressed,val:compressed.charCodeAt(0),position:32768,index:1};power!=maxpower;)resb=data.val&data.position,data.position>>=1,0===data.position&&(data.position=32768,data.val=data.string.charCodeAt(data.index++)),bits|=(resb>0?1:0)*power,power<<=1;switch(bits){case 0:for(bits=0,maxpower=Math.pow(2,8),power=1;power!=maxpower;)resb=data.val&data.position,data.position>>=1,0===data.position&&(data.position=32768,data.val=data.string.charCodeAt(data.index++)),bits|=(resb>0?1:0)*power,power<<=1;c=f(bits);break;case 1:for(bits=0,maxpower=Math.pow(2,16),power=1;power!=maxpower;)resb=data.val&data.position,data.position>>=1,0===data.position&&(data.position=32768,data.val=data.string.charCodeAt(data.index++)),bits|=(resb>0?1:0)*power,power<<=1;c=f(bits);break;case 2:return""}for(dictionary[3]=c,w=result=c;;){if(data.index>data.string.length)return console.log("Decompression error5"),"";for(bits=0,maxpower=Math.pow(2,numBits),power=1;power!=maxpower;)resb=data.val&data.position,data.position>>=1,0===data.position&&(data.position=32768,data.val=data.string.charCodeAt(data.index++)),bits|=(resb>0?1:0)*power,power<<=1;switch(c=bits){case 0:for(bits=0,maxpower=Math.pow(2,8),power=1;power!=maxpower;)resb=data.val&data.position,data.position>>=1,0===data.position&&(data.position=32768,data.val=data.string.charCodeAt(data.index++)),bits|=(resb>0?1:0)*power,power<<=1;dictionary[dictSize++]=f(bits),c=dictSize-1,enlargeIn--;break;case 1:for(bits=0,maxpower=Math.pow(2,16),power=1;power!=maxpower;)resb=data.val&data.position,data.position>>=1,0===data.position&&(data.position=32768,data.val=data.string.charCodeAt(data.index++)),bits|=(resb>0?1:0)*power,power<<=1;dictionary[dictSize++]=f(bits),c=dictSize-1,enlargeIn--;break;case 2:return result}if(0===enlargeIn&&(enlargeIn=Math.pow(2,numBits),numBits++),dictionary[c])entry=dictionary[c];else{if(c!==dictSize||!w)return null;entry=w+w.charAt(0)}result+=entry,dictionary[dictSize++]=w+entry.charAt(0),w=entry,0===--enlargeIn&&(enlargeIn=Math.pow(2,numBits),numBits++)}}var bigInt=function(undefined){var BASE=1e7,LOG_BASE=7,MAX_INT=9007199254740992,MAX_INT_ARR=smallToArray(MAX_INT),DEFAULT_ALPHABET="0123456789abcdefghijklmnopqrstuvwxyz";function Integer(v,radix,alphabet,caseSensitive){return void 0===v?Integer[0]:void 0!==radix&&(10!=+radix||alphabet)?parseBase(v,radix,alphabet,caseSensitive):parseValue(v)}function BigInteger(value,sign){this.value=value,this.sign=sign,this.isSmall=!1}function SmallInteger(value){this.value=value,this.sign=value<0,this.isSmall=!0}function isPrecise(n){return-MAX_INT<n&&n<MAX_INT}function smallToArray(n){return n<1e7?[n]:n<1e14?[n%1e7,Math.floor(n/1e7)]:[n%1e7,Math.floor(n/1e7)%1e7,Math.floor(n/1e14)]}function arrayToSmall(arr){trim(arr);var length=arr.length;if(length<4&&compareAbs(arr,MAX_INT_ARR)<0)switch(length){case 0:return 0;case 1:return arr[0];case 2:return arr[0]+1e7*arr[1];default:return arr[0]+1e7*(arr[1]+1e7*arr[2])}return arr}function trim(v){for(var i=v.length;0===v[--i];);v.length=i+1}function createArray(length){for(var x=new Array(length),i=-1;++i<length;)x[i]=0;return x}function truncate(n){return n>0?Math.floor(n):Math.ceil(n)}function add(a,b){var l_a=a.length,l_b=b.length,r=new Array(l_a),carry=0,base=1e7,sum,i;for(i=0;i<l_b;i++)carry=(sum=a[i]+b[i]+carry)>=1e7?1:0,r[i]=sum-1e7*carry;for(;i<l_a;)carry=1e7===(sum=a[i]+carry)?1:0,r[i++]=sum-1e7*carry;return carry>0&&r.push(carry),r}function addAny(a,b){return a.length>=b.length?add(a,b):add(b,a)}function addSmall(a,carry){var l=a.length,r=new Array(l),base=1e7,sum,i;for(i=0;i<l;i++)sum=a[i]-1e7+carry,carry=Math.floor(sum/1e7),r[i]=sum-1e7*carry,carry+=1;for(;carry>0;)r[i++]=carry%1e7,carry=Math.floor(carry/1e7);return r}function subtract(a,b){var a_l=a.length,b_l=b.length,r=new Array(a_l),borrow=0,base=1e7,i,difference;for(i=0;i<b_l;i++)(difference=a[i]-borrow-b[i])<0?(difference+=1e7,borrow=1):borrow=0,r[i]=difference;for(i=b_l;i<a_l;i++){if(!((difference=a[i]-borrow)<0)){r[i++]=difference;break}difference+=1e7,r[i]=difference}for(;i<a_l;i++)r[i]=a[i];return trim(r),r}function subtractAny(a,b,sign){var value;return compareAbs(a,b)>=0?value=subtract(a,b):(value=subtract(b,a),sign=!sign),"number"==typeof(value=arrayToSmall(value))?(sign&&(value=-value),new SmallInteger(value)):new BigInteger(value,sign)}function subtractSmall(a,b,sign){var l=a.length,r=new Array(l),carry=-b,base=1e7,i,difference;for(i=0;i<l;i++)difference=a[i]+carry,carry=Math.floor(difference/1e7),difference%=1e7,r[i]=difference<0?difference+1e7:difference;return"number"==typeof(r=arrayToSmall(r))?(sign&&(r=-r),new SmallInteger(r)):new BigInteger(r,sign)}function multiplyLong(a,b){var a_l=a.length,b_l=b.length,l,r=createArray(a_l+b_l),base=1e7,product,carry,i,a_i,b_j;for(i=0;i<a_l;++i){a_i=a[i];for(var j=0;j<b_l;++j)product=a_i*(b_j=b[j])+r[i+j],carry=Math.floor(product/1e7),r[i+j]=product-1e7*carry,r[i+j+1]+=carry}return trim(r),r}function multiplySmall(a,b){var l=a.length,r=new Array(l),base=1e7,carry=0,product,i;for(i=0;i<l;i++)product=a[i]*b+carry,carry=Math.floor(product/1e7),r[i]=product-1e7*carry;for(;carry>0;)r[i++]=carry%1e7,carry=Math.floor(carry/1e7);return r}function shiftLeft(x,n){for(var r=[];n-- >0;)r.push(0);return r.concat(x)}function multiplyKaratsuba(x,y){var n=Math.max(x.length,y.length);if(n<=30)return multiplyLong(x,y);n=Math.ceil(n/2);var b=x.slice(n),a=x.slice(0,n),d=y.slice(n),c=y.slice(0,n),ac=multiplyKaratsuba(a,c),bd=multiplyKaratsuba(b,d),abcd=multiplyKaratsuba(addAny(a,b),addAny(c,d)),product=addAny(addAny(ac,shiftLeft(subtract(subtract(abcd,ac),bd),n)),shiftLeft(bd,2*n));return trim(product),product}function useKaratsuba(l1,l2){return-.012*l1-.012*l2+15e-6*l1*l2>0}function multiplySmallAndArray(a,b,sign){return new BigInteger(a<1e7?multiplySmall(b,a):multiplyLong(b,smallToArray(a)),sign)}function square(a){var l=a.length,r=createArray(l+l),base=1e7,product,carry,i,a_i,a_j;for(i=0;i<l;i++){carry=0-(a_i=a[i])*a_i;for(var j=i;j<l;j++)product=a_i*(a_j=a[j])*2+r[i+j]+carry,carry=Math.floor(product/1e7),r[i+j]=product-1e7*carry;r[i+l]=carry}return trim(r),r}function divMod1(a,b){var a_l=a.length,b_l=b.length,base=1e7,result=createArray(b.length),divisorMostSignificantDigit=b[b_l-1],lambda=Math.ceil(1e7/(2*divisorMostSignificantDigit)),remainder=multiplySmall(a,lambda),divisor=multiplySmall(b,lambda),quotientDigit,shift,carry,borrow,i,l,q;for(remainder.length<=a_l&&remainder.push(0),divisor.push(0),divisorMostSignificantDigit=divisor[b_l-1],shift=a_l-b_l;shift>=0;shift--){for(quotientDigit=1e7-1,remainder[shift+b_l]!==divisorMostSignificantDigit&&(quotientDigit=Math.floor((1e7*remainder[shift+b_l]+remainder[shift+b_l-1])/divisorMostSignificantDigit)),carry=0,borrow=0,l=divisor.length,i=0;i<l;i++)carry+=quotientDigit*divisor[i],q=Math.floor(carry/1e7),borrow+=remainder[shift+i]-(carry-1e7*q),carry=q,borrow<0?(remainder[shift+i]=borrow+1e7,borrow=-1):(remainder[shift+i]=borrow,borrow=0);for(;0!==borrow;){for(quotientDigit-=1,carry=0,i=0;i<l;i++)(carry+=remainder[shift+i]-1e7+divisor[i])<0?(remainder[shift+i]=carry+1e7,carry=0):(remainder[shift+i]=carry,carry=1);borrow+=carry}result[shift]=quotientDigit}return remainder=divModSmall(remainder,lambda)[0],[arrayToSmall(result),arrayToSmall(remainder)]}function divMod2(a,b){for(var a_l=a.length,b_l=b.length,result=[],part=[],base=1e7,guess,xlen,highx,highy,check;a_l;)if(part.unshift(a[--a_l]),trim(part),compareAbs(part,b)<0)result.push(0);else{highx=1e7*part[(xlen=part.length)-1]+part[xlen-2],highy=1e7*b[b_l-1]+b[b_l-2],xlen>b_l&&(highx=1e7*(highx+1)),guess=Math.ceil(highx/highy);do{if(compareAbs(check=multiplySmall(b,guess),part)<=0)break;guess--}while(guess);result.push(guess),part=subtract(part,check)}return result.reverse(),[arrayToSmall(result),arrayToSmall(part)]}function divModSmall(value,lambda){var length=value.length,quotient=createArray(length),base=1e7,i,q,remainder,divisor;for(remainder=0,i=length-1;i>=0;--i)remainder=(divisor=1e7*remainder+value[i])-(q=truncate(divisor/lambda))*lambda,quotient[i]=0|q;return[quotient,0|remainder]}function divModAny(self,v){var value,n=parseValue(v),a=self.value,b=n.value,quotient;if(0===b)throw new Error("Cannot divide by zero");if(self.isSmall)return n.isSmall?[new SmallInteger(truncate(a/b)),new SmallInteger(a%b)]:[Integer[0],self];if(n.isSmall){if(1===b)return[self,Integer[0]];if(-1==b)return[self.negate(),Integer[0]];var abs=Math.abs(b);if(abs<1e7){quotient=arrayToSmall((value=divModSmall(a,abs))[0]);var remainder=value[1];return self.sign&&(remainder=-remainder),"number"==typeof quotient?(self.sign!==n.sign&&(quotient=-quotient),[new SmallInteger(quotient),new SmallInteger(remainder)]):[new BigInteger(quotient,self.sign!==n.sign),new SmallInteger(remainder)]}b=smallToArray(abs)}var comparison=compareAbs(a,b);if(-1===comparison)return[Integer[0],self];if(0===comparison)return[Integer[self.sign===n.sign?1:-1],Integer[0]];quotient=(value=a.length+b.length<=200?divMod1(a,b):divMod2(a,b))[0];var qSign=self.sign!==n.sign,mod=value[1],mSign=self.sign;return"number"==typeof quotient?(qSign&&(quotient=-quotient),quotient=new SmallInteger(quotient)):quotient=new BigInteger(quotient,qSign),"number"==typeof mod?(mSign&&(mod=-mod),mod=new SmallInteger(mod)):mod=new BigInteger(mod,mSign),[quotient,mod]}function compareAbs(a,b){if(a.length!==b.length)return a.length>b.length?1:-1;for(var i=a.length-1;i>=0;i--)if(a[i]!==b[i])return a[i]>b[i]?1:-1;return 0}BigInteger.prototype=Object.create(Integer.prototype),SmallInteger.prototype=Object.create(Integer.prototype),BigInteger.prototype.add=function(v){var n=parseValue(v);if(this.sign!==n.sign)return this.subtract(n.negate());var a=this.value,b=n.value;return n.isSmall?new BigInteger(addSmall(a,Math.abs(b)),this.sign):new BigInteger(addAny(a,b),this.sign)},BigInteger.prototype.plus=BigInteger.prototype.add,SmallInteger.prototype.add=function(v){var n=parseValue(v),a=this.value;if(a<0!==n.sign)return this.subtract(n.negate());var b=n.value;if(n.isSmall){if(isPrecise(a+b))return new SmallInteger(a+b);b=smallToArray(Math.abs(b))}return new BigInteger(addSmall(b,Math.abs(a)),a<0)},SmallInteger.prototype.plus=SmallInteger.prototype.add,BigInteger.prototype.subtract=function(v){var n=parseValue(v);if(this.sign!==n.sign)return this.add(n.negate());var a=this.value,b=n.value;return n.isSmall?subtractSmall(a,Math.abs(b),this.sign):subtractAny(a,b,this.sign)},BigInteger.prototype.minus=BigInteger.prototype.subtract,SmallInteger.prototype.subtract=function(v){var n=parseValue(v),a=this.value;if(a<0!==n.sign)return this.add(n.negate());var b=n.value;return n.isSmall?new SmallInteger(a-b):subtractSmall(b,Math.abs(a),a>=0)},SmallInteger.prototype.minus=SmallInteger.prototype.subtract,BigInteger.prototype.negate=function(){return new BigInteger(this.value,!this.sign)},SmallInteger.prototype.negate=function(){var sign=this.sign,small=new SmallInteger(-this.value);return small.sign=!sign,small},BigInteger.prototype.abs=function(){return new BigInteger(this.value,!1)},SmallInteger.prototype.abs=function(){return new SmallInteger(Math.abs(this.value))},BigInteger.prototype.multiply=function(v){var n=parseValue(v),a=this.value,b=n.value,sign=this.sign!==n.sign,abs;if(n.isSmall){if(0===b)return Integer[0];if(1===b)return this;if(-1===b)return this.negate();if((abs=Math.abs(b))<1e7)return new BigInteger(multiplySmall(a,abs),sign);b=smallToArray(abs)}return useKaratsuba(a.length,b.length)?new BigInteger(multiplyKaratsuba(a,b),sign):new BigInteger(multiplyLong(a,b),sign)},BigInteger.prototype.times=BigInteger.prototype.multiply,SmallInteger.prototype._multiplyBySmall=function(a){return isPrecise(a.value*this.value)?new SmallInteger(a.value*this.value):multiplySmallAndArray(Math.abs(a.value),smallToArray(Math.abs(this.value)),this.sign!==a.sign)},BigInteger.prototype._multiplyBySmall=function(a){return 0===a.value?Integer[0]:1===a.value?this:-1===a.value?this.negate():multiplySmallAndArray(Math.abs(a.value),this.value,this.sign!==a.sign)},SmallInteger.prototype.multiply=function(v){return parseValue(v)._multiplyBySmall(this)},SmallInteger.prototype.times=SmallInteger.prototype.multiply,BigInteger.prototype.square=function(){return new BigInteger(square(this.value),!1)},SmallInteger.prototype.square=function(){var value=this.value*this.value;return isPrecise(value)?new SmallInteger(value):new BigInteger(square(smallToArray(Math.abs(this.value))),!1)},BigInteger.prototype.divmod=function(v){var result=divModAny(this,v);return{quotient:result[0],remainder:result[1]}},SmallInteger.prototype.divmod=BigInteger.prototype.divmod,BigInteger.prototype.divide=function(v){return divModAny(this,v)[0]},SmallInteger.prototype.over=SmallInteger.prototype.divide=BigInteger.prototype.over=BigInteger.prototype.divide,BigInteger.prototype.mod=function(v){return divModAny(this,v)[1]},SmallInteger.prototype.remainder=SmallInteger.prototype.mod=BigInteger.prototype.remainder=BigInteger.prototype.mod,BigInteger.prototype.modPow=function(exp,mod){if(exp=parseValue(exp),(mod=parseValue(mod)).isZero())throw new Error("Cannot take modPow with modulus 0");for(var r=Integer[1],base=this.mod(mod);exp.isPositive();){if(base.isZero())return Integer[0];exp.isOdd()&&(r=r.multiply(base).mod(mod)),exp=exp.divide(2),base=base.square().mod(mod)}return r},SmallInteger.prototype.modPow=BigInteger.prototype.modPow,BigInteger.prototype.compareAbs=function(v){var n=parseValue(v),a=this.value,b=n.value;return n.isSmall?1:compareAbs(a,b)},SmallInteger.prototype.compareAbs=function(v){var n=parseValue(v),a=Math.abs(this.value),b=n.value;return n.isSmall?a===(b=Math.abs(b))?0:a>b?1:-1:-1},BigInteger.prototype.compare=function(v){if(v===1/0)return-1;if(v===-1/0)return 1;var n=parseValue(v),a=this.value,b=n.value;return this.sign!==n.sign?n.sign?1:-1:n.isSmall?this.sign?-1:1:compareAbs(a,b)*(this.sign?-1:1)},BigInteger.prototype.compareTo=BigInteger.prototype.compare,SmallInteger.prototype.compare=function(v){if(v===1/0)return-1;if(v===-1/0)return 1;var n=parseValue(v),a=this.value,b=n.value;return n.isSmall?a==b?0:a>b?1:-1:a<0!==n.sign?a<0?-1:1:a<0?1:-1},SmallInteger.prototype.compareTo=SmallInteger.prototype.compare,BigInteger.prototype.equals=function(v){return 0===this.compare(v)},SmallInteger.prototype.eq=SmallInteger.prototype.equals=BigInteger.prototype.eq=BigInteger.prototype.equals,BigInteger.prototype.isOdd=function(){return 1==(1&this.value[0])},SmallInteger.prototype.isOdd=function(){return 1==(1&this.value)},BigInteger.prototype.isPositive=function(){return!this.sign},SmallInteger.prototype.isPositive=function(){return this.value>0},BigInteger.prototype.isNegative=function(){return this.sign},SmallInteger.prototype.isNegative=function(){return this.value<0},BigInteger.prototype.isUnit=function(){return!1},SmallInteger.prototype.isUnit=function(){return 1===Math.abs(this.value)},BigInteger.prototype.isZero=function(){return!1},SmallInteger.prototype.isZero=function(){return 0===this.value},BigInteger.prototype.next=function(){var value=this.value;return this.sign?subtractSmall(value,1,this.sign):new BigInteger(addSmall(value,1),this.sign)},SmallInteger.prototype.next=function(){var value=this.value;return value+1<MAX_INT?new SmallInteger(value+1):new BigInteger(MAX_INT_ARR,!1)};var parseBase=function(text,base,alphabet,caseSensitive){alphabet=alphabet||DEFAULT_ALPHABET,text=String(text),caseSensitive||(text=text.toLowerCase(),alphabet=alphabet.toLowerCase());var length=text.length,i,absBase=Math.abs(base),alphabetValues={};for(i=0;i<alphabet.length;i++)alphabetValues[alphabet[i]]=i;for(i=0;i<length;i++){var c;if("-"!==(c=text[i])&&(c in alphabetValues&&alphabetValues[c]>=absBase)){if("1"===c&&1===absBase)continue;throw new Error(c+" is not a valid digit in base "+base+".")}}base=parseValue(base);var digits=[],isNegative="-"===text[0];for(i=isNegative?1:0;i<text.length;i++){var c;if((c=text[i])in alphabetValues)digits.push(parseValue(alphabetValues[c]));else{if("<"!==c)throw new Error(c+" is not a valid character");var start=i;do{i++}while(">"!==text[i]&&i<text.length);digits.push(parseValue(text.slice(start+1,i)))}}return parseBaseFromArray(digits,base,isNegative)};function parseBaseFromArray(digits,base,isNegative){var val=Integer[0],pow=Integer[1],i;for(i=digits.length-1;i>=0;i--)val=val.add(digits[i].times(pow)),pow=pow.times(base);return isNegative?val.negate():val}function stringify(digit,alphabet){return digit<(alphabet=alphabet||DEFAULT_ALPHABET).length?alphabet[digit]:"<"+digit+">"}function toBase(n,base){if((base=bigInt(base)).isZero()){if(n.isZero())return{value:[0],isNegative:!1};throw new Error("Cannot convert nonzero numbers to base 0.")}if(base.equals(-1)){if(n.isZero())return{value:[0],isNegative:!1};if(n.isNegative())return{value:[].concat.apply([],Array.apply(null,Array(-n.toJSNumber())).map(Array.prototype.valueOf,[1,0])),isNegative:!1};var arr=Array.apply(null,Array(n.toJSNumber()-1)).map(Array.prototype.valueOf,[0,1]);return arr.unshift([1]),{value:[].concat.apply([],arr),isNegative:!1}}var neg=!1;if(n.isNegative()&&base.isPositive()&&(neg=!0,n=n.abs()),base.isUnit())return n.isZero()?{value:[0],isNegative:!1}:{value:Array.apply(null,Array(n.toJSNumber())).map(Number.prototype.valueOf,1),isNegative:neg};for(var out=[],left=n,divmod;left.isNegative()||left.compareAbs(base)>=0;){divmod=left.divmod(base),left=divmod.quotient;var digit=divmod.remainder;digit.isNegative()&&(digit=base.minus(digit).abs(),left=left.next()),out.push(digit.toJSNumber())}return out.push(left.toJSNumber()),{value:out.reverse(),isNegative:neg}}function toBaseString(n,base,alphabet){var arr=toBase(n,base);return(arr.isNegative?"-":"")+arr.value.map((function(x){return stringify(x,alphabet)})).join("")}function parseStringValue(v){if(isPrecise(+v)){var x=+v;if(x===truncate(x))return new SmallInteger(x);throw new Error("Invalid integer: "+v)}var sign="-"===v[0];sign&&(v=v.slice(1));var split=v.split(/e/i),isValid;if(split.length>2)throw new Error("Invalid integer: "+split.join("e"));if(2===split.length){var exp=split[1];if("+"===exp[0]&&(exp=exp.slice(1)),(exp=+exp)!==truncate(exp)||!isPrecise(exp))throw new Error("Invalid integer: "+exp+" is not a valid exponent.");var text=split[0],decimalPlace=text.indexOf(".");if(decimalPlace>=0&&(exp-=text.length-decimalPlace-1,text=text.slice(0,decimalPlace)+text.slice(decimalPlace+1)),exp<0)throw new Error("Cannot include negative exponent part for integers");v=text+=new Array(exp+1).join("0")}if(!/^([0-9][0-9]*)$/.test(v))throw new Error("Invalid integer: "+v);for(var r=[],max=v.length,l=7,min=max-7;max>0;)r.push(+v.slice(min,max)),(min-=7)<0&&(min=0),max-=7;return trim(r),new BigInteger(r,sign)}function parseNumberValue(v){if(isPrecise(v)){if(v!==truncate(v))throw new Error(v+" is not an integer.");return new SmallInteger(v)}return parseStringValue(v.toString())}function parseValue(v){return"number"==typeof v?parseNumberValue(v):"string"==typeof v?parseStringValue(v):v}BigInteger.prototype.toString=function(radix,alphabet){if(void 0===radix&&(radix=10),10!==radix)return toBaseString(this,radix,alphabet);for(var v=this.value,l=v.length,str=String(v[--l]),zeros="0000000",digit;--l>=0;)digit=String(v[l]),str+=zeros.slice(digit.length)+digit;var sign;return(this.sign?"-":"")+str},SmallInteger.prototype.toString=function(radix,alphabet){return void 0===radix&&(radix=10),10!=radix?toBaseString(this,radix,alphabet):String(this.value)},BigInteger.prototype.valueOf=function(){return parseInt(this.toString(),10)},BigInteger.prototype.toJSNumber=BigInteger.prototype.valueOf,SmallInteger.prototype.valueOf=function(){return this.value},SmallInteger.prototype.toJSNumber=SmallInteger.prototype.valueOf;for(var i=0;i<1e3;i++)Integer[i]=parseValue(i),i>0&&(Integer[-i]=parseValue(-i));return Integer}();function sha256(str){var h0=1779033703,h1=3144134277,h2=1013904242,h3=2773480762,h4=1359893119,h5=2600822924,h6=528734635,h7=1541459225,K=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],s=unescape(encodeURIComponent(str)),i,arr=new Uint8Array(s.length);for(i=0;i<s.length;i++)arr[i]=255&s.charCodeAt(i);var length=arr.length,byteLength=64*Math.floor((length+72)/64),wordLength=byteLength/4,bitLength=8*length,m=new Uint8Array(byteLength);if("undefined"==typeof Uint8Array||Array.isArray(m)){for(i=0;i<arr.length;i++)m[i]=arr[i];for(i=arr.length;i<m.length;i++)m[i]=0}else m.set(arr);m[length]=128,m[byteLength-4]=bitLength>>>24,m[byteLength-3]=bitLength>>>16&255,m[byteLength-2]=bitLength>>>8&255,m[byteLength-1]=255&bitLength;var words=new Int32Array(wordLength),byteIndex=0,word;for(i=0;i<words.length;i++)word=m[byteIndex]<<24,word|=m[byteIndex+1]<<16,word|=m[byteIndex+2]<<8,word|=m[byteIndex+3],words[i]=word,byteIndex+=4;word=null,byteIndex=null;for(var w=new Int32Array(64),v,s0,s1,a,b,c,d,e,f,g,h,ch,temp1,temp2,maj,j=0;j<wordLength;j+=16){for(i=0;i<16;i++)w[i]=words[j+i];for(i=16;i<64;i++)s0=(v=w[i-15])>>>7|v<<25,s0^=v>>>18|v<<14,s0^=v>>>3,s1=(v=w[i-2])>>>17|v<<15,s1^=v>>>19|v<<13,s1^=v>>>10,w[i]=w[i-16]+s0+w[i-7]+s1&4294967295;for(a=h0,b=h1,c=h2,d=h3,e=h4,f=h5,g=h6,h=h7,i=0;i<64;i++)s1=e>>>6|e<<26,s1^=e>>>11|e<<21,temp1=h+(s1^=e>>>25|e<<7)+(ch=e&f^~e&g)+K[i]+w[i]&4294967295,s0=a>>>2|a<<30,s0^=a>>>13|a<<19,maj=a&b^a&c^b&c,h=g,g=f,f=e,e=d+temp1&4294967295,d=c,c=b,b=a,a=temp1+(temp2=(s0^=a>>>22|a<<10)+maj&4294967295)&4294967295;h0=h0+a&4294967295,h1=h1+b&4294967295,h2=h2+c&4294967295,h3=h3+d&4294967295,h4=h4+e&4294967295,h5=h5+f&4294967295,h6=h6+g&4294967295,h7=h7+h&4294967295}var hash=new Uint8Array(32);for(i=0;i<4;i++)hash[i]=h0>>>8*(3-i)&255,hash[i+4]=h1>>>8*(3-i)&255,hash[i+8]=h2>>>8*(3-i)&255,hash[i+12]=h3>>>8*(3-i)&255,hash[i+16]=h4>>>8*(3-i)&255,hash[i+20]=h5>>>8*(3-i)&255,hash[i+24]=h6>>>8*(3-i)&255,hash[i+28]=h7>>>8*(3-i)&255;return hash}function getSessionKey(privateKey,publicKey){return bigInt(publicKey).modPow(b64.number_hash(privateKey,100),prime).toString()}return b64.atob=function(str){function fromUtf8(str){var position=-1,len,buffer=[],enc=[0,0,0,0];if(!lookup){for(len=charset.length,lookup={};++position<len;)lookup[charset.charAt(position)]=position;position=-1}for(len=str.length;++position<len&&(enc[0]=lookup[str.charAt(position)],enc[1]=lookup[str.charAt(++position)],buffer.push(enc[0]<<2|enc[1]>>4),enc[2]=lookup[str.charAt(++position)],64!==enc[2])&&(buffer.push((15&enc[1])<<4|enc[2]>>2),enc[3]=lookup[str.charAt(++position)],64!==enc[3]);)buffer.push((3&enc[2])<<6|enc[3]);return buffer}var lookup=null;if(str.length%4)throw new Error("InvalidCharacterError: 'Base64.atob' failed: The string to be decoded is not correctly encoded.");for(var buffer=fromUtf8(str),position=0,len=buffer.length,result="";position<len;)buffer[position]<128?result+=String.fromCharCode(buffer[position++]):buffer[position]>191&&buffer[position]<224?result+=String.fromCharCode((31&buffer[position++])<<6|63&buffer[position++]):result+=String.fromCharCode((15&buffer[position++])<<12|(63&buffer[position++])<<6|63&buffer[position++]);return result},b64.btoa=function(s){function toUtf8(s){var position=-1,len=s.length,chr,buffer=[];if(/^[\x00-\x7f]*$/.test(s))for(;++position<len;)buffer.push(s.charCodeAt(position));else for(;++position<len;)(chr=s.charCodeAt(position))<128?buffer.push(chr):chr<2048?buffer.push(chr>>6|192,63&chr|128):buffer.push(chr>>12|224,chr>>6&63|128,63&chr|128);return buffer}for(var buffer=toUtf8(s),position=-1,len=buffer.length,nan0,nan1,nan2,enc=[0,0,0,0],result="";++position<len;)nan0=buffer[position],nan1=buffer[++position],enc[0]=nan0>>2,enc[1]=(3&nan0)<<4|nan1>>4,isNaN(nan1)?enc[2]=enc[3]=64:(nan2=buffer[++position],enc[2]=(15&nan1)<<2|nan2>>6,enc[3]=isNaN(nan2)?64:63&nan2),result+=charset[enc[0]]+charset[enc[1]]+charset[enc[2]]+charset[enc[3]];return result},b64.number_hash=function(str,requiredLength){requiredLength=requiredLength&&!isNaN(requiredLength)&&isFinite(requiredLength)&&requiredLength>0?requiredLength:10;for(var out="",a=0,h=0,s="",i=void 0,chr=void 0,len=void 0;out.length<requiredLength;a++){for(i=0,len=str.length;i<len;i++)h=(h<<5)-h+(chr=str.charCodeAt(i)),h|=0;for(s=String(h+Math.pow(2,31));s.length<10;)s="0"+h;out+=s.slice(2)}return out.slice(0,requiredLength)},b64.rand=function(requiredLength,additionalEntropy){function random12Digit(){return String(Math.floor(Math.random()*(Math.pow(10,16)-1-Math.pow(10,15)+1)+Math.pow(10,15))).slice(3,15)}var len=requiredLength&&!isNaN(requiredLength)&&isFinite(requiredLength)&&requiredLength>0?requiredLength:8,ent=additionalEntropy?String(additionalEntropy):random12Digit(),num=0,str="",out="";for(len>300&&(len=300);out.length<len;){num=Number(random12Digit());for(var b=0;b<4300;b++)num+=Number(String((new Date).getTime()).slice(7));for(str=String(num);"0"===str.charAt(0)&&str.length>1;)str=str.slice(1);out+=str=b64.number_hash(ent+str,8)}for(;"0"===out.charAt(0)&&out.length>1;)out=out.slice(1);return out.length<len?b64.rand(len,ent+random12Digit()):out.slice(0,len)},b64.hash=function(message,salt){return message=message||"",toHex(sha256(message=salt?String(salt)+String(message):String(message.length+1231)+String(message)))},b64.hmac=function(message,key){var k;if((key=String(key)).length>32)k=sha256(key);else{var s=unescape(encodeURIComponent(key));k=new Uint8Array(32);for(var i=0;i<s.length;i++)k[i]=s.charCodeAt(i)}for(var i=0;i<k.length;i++)k[i]^=54;for(var inner=toHex(sha256(toHex(k))),i=0;i<k.length;i++)k[i]^=106;return b64.hash(String(message),toHex(k)+inner)},b64.write=function(str,key){if(null==str)return"";if(str=convertTo(str=String(str)),key){var a,b=[],c=charset,d=b64.hash(key),e,f=c+c+c+c+c;for(a=0,e=0;a<str.length;a++,e=e===String(d).length-1?0:e+1)b[a]=f[c.indexOf(str[a])+4*c.indexOf(String(d)[e])];str="d"+b.join(""),a=null,b=null,c=null,d=null,e=null,f=null,key=null}return str},b64.read=function(str,key){if(null==str)return"";if(str=String(str),key&&/^d/.test(str)){var a=(str=str.replace(/^d/,"")).length,b=[],c=charset,d=b64.hash(key),e,f=c+c+c+c+c,g,h=String(d).length,i=c.length;for(g=0,e=0;g<a;g++,e=e===h-1?0:e+1)b[g]=f[c.indexOf(str[g])+4*i-4*c.indexOf(String(d)[e])];str=b.join(""),key=null,a=null,b=null,c=null,d=null,e=null,f=null,g=null}return revertFrom(str)},b64.write_and_verify=function(str,key){function locateTextDifferences(str1,str2){var diff=[],d=1;if(null===str2)return"Decompressing the string returned null. Possibly invalid key used??";var len1=str1.length,len2=str2.length;diff[0]=len1!==len2?"Strings are not the same length. String 1: "+len1+" characters. String 2: "+len2+" characters.":"Entire text length: "+len1+" characters";for(var a=0;a<len1&&a<len2;a++)str1.charAt(a)!==str2.charAt(a)&&(diff[d]="Char "+(a+1)+": ASCII "+str1.charCodeAt(a)+" not equal to ",diff[d]=diff[d]+"ASCII "+str2.charCodeAt(a)+".",diff[d]=diff[d]+"Surrounding text: "+str1.slice(a-10,a+10),d++);return 1!==d&&diff.join("<br />")}var orig=str;return str=b64.write(str,key),b64.read(str,key)!==orig?"Write error! Aborted operation. "+locateTextDifferences(orig,b64.read(str,key)):str},b64.createPublicKey=function(myPrivateKey){var ret;return myPrivateKey=b64.number_hash(myPrivateKey,100),bigInt("32416178251").modPow(myPrivateKey,prime).toString()},b64.createUserKey=function(userPublicKey,masterKey){return b64.write("key:"+masterKey,getSessionKey(masterKey,userPublicKey))},b64.createUserKey_and_verify=function(userPrivateKey,masterKey){var mainPublicKey=b64.createPublicKey(masterKey),userPublicKey=b64.createPublicKey(userPrivateKey),usersSessionKey=getSessionKey(userPrivateKey,mainPublicKey),mainSessionKey=getSessionKey(masterKey,userPublicKey);if(usersSessionKey!==mainSessionKey)throw new Error("Public/Private key creation error");var userKey=b64.write_and_verify("key:"+masterKey,mainSessionKey);if(String(masterKey)===String(b64.readUserKey(userPrivateKey,userKey,mainPublicKey)))return userKey;throw new Error("Error creating user key for "+userPrivateKey)},b64.readUserKey=function(myPrivateKey,userKey,mainPublicKey){var key=b64.read(userKey,getSessionKey(myPrivateKey,mainPublicKey));return!!/^key:/.test(key)&&key.replace(/^key:/,"")},b64.share=function(str,myPrivateKey,theirPublicKeys,expires){var key=b64.rand(prime.length),members=[b64.createUserKey(b64.createPublicKey(myPrivateKey),key)];if(expires=expires&&!isNaN(expires)&&isFinite(expires)?(new Date).getTime()+26298e5*expires:!!expires&&(new Date).getTime()+473364e5,str=b64.write(str,key),theirPublicKeys&&theirPublicKeys instanceof Array)for(var a=0;a<theirPublicKeys.length;a++)members[a+1]=b64.createUserKey(theirPublicKeys[a],key);return{Version:b64.Version,Expires:expires,Compressed:!0,Data:str,PublicKey:b64.createPublicKey(key),UserKeys:b64.write_and_verify(JSON.stringify(members)),Signature:b64.hmac(str+expires,key)}},b64.readShared=function(obj,myPrivateKey){var key,type="error",message="",data,hash;if(obj.Version===b64.Version||1===obj.Version){if(obj.UserKeys&&obj.Compressed){for(var members=JSON.parse(b64.read(obj.UserKeys)),a=0,len=members.length;a<len;a++)b64.readUserKey(myPrivateKey,members[a],obj.PublicKey)&&(key=b64.readUserKey(myPrivateKey,members[a],obj.PublicKey));members=null}!1!==obj.Expires&&(new Date).getTime()>obj.Expires?message="data expired":key?1===obj.Version?(data=b64.read(obj.Data,key),hash=b64.hash(data+obj.Expires),obj.Signature===hash?(type="results",message="success"):(data=null,message="hash didn't match")):(hash=b64.hmac(obj.Data+obj.Expires,key),obj.Signature===hash?(data=b64.read(obj.Data,key),type="results",message="success"):(data=null,message="hmac didn't match")):message="no key match"}else message="file version '"+obj.Version+"' not supported";return{type:type,message:message,data:data,hmac:hash}},b64}();