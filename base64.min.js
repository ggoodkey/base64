"use strict";
/*!
* Base64 performs several functions:
* Compress a string to base64, Diffie Hellman Merkle key exchange,
* SHA256 hash, and generate high entropy random numbers.
* Generated public Keys are numeric and 300 digits in length (~1000 bit equivelent).
*
* Last Modified: August 12, 2020
* Copyright (C) 2020 Graeme Goodkey github.com/ggoodkey
* All rights reserved
*
* Released free of charge for inclusion in your own applications, as is or as modified by you.
* DISTRIBUTED "AS IS", WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND.
*
* Converting to Base 64 is based on Vassilis Petroulias' base64v1_0.js
* http://jsbase64.codeplex.com/
*
* Compression is based on Sam Hocevar's lz-string-1.3.3.js
* http://pieroxy.net/blog/pages/lz-string/index.html
*
* Handling big integers is a subset of BigInteger.js by peterolson
* https://www.npmjs.com/package/big-integer/
*
*/var Base64=function(){var e={Version:1.2},r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",t="00,01,02,03,04,05,06,07,08,09,0a,0b,0c,0d,0e,0f,10,11,12,13,14,15,16,17,18,19,1a,1b,1c,1d,1e,1f,20,21,22,23,24,25,26,27,28,29,2a,2b,2c,2d,2e,2f,30,31,32,33,34,35,36,37,38,39,3a,3b,3c,3d,3e,3f,40,41,42,43,44,45,46,47,48,49,4a,4b,4c,4d,4e,4f,50,51,52,53,54,55,56,57,58,59,5a,5b,5c,5d,5e,5f,60,61,62,63,64,65,66,67,68,69,6a,6b,6c,6d,6e,6f,70,71,72,73,74,75,76,77,78,79,7a,7b,7c,7d,7e,7f,80,81,82,83,84,85,86,87,88,89,8a,8b,8c,8d,8e,8f,90,91,92,93,94,95,96,97,98,99,9a,9b,9c,9d,9e,9f,a0,a1,a2,a3,a4,a5,a6,a7,a8,a9,aa,ab,ac,ad,ae,af,b0,b1,b2,b3,b4,b5,b6,b7,b8,b9,ba,bb,bc,bd,be,bf,c0,c1,c2,c3,c4,c5,c6,c7,c8,c9,ca,cb,cc,cd,ce,cf,d0,d1,d2,d3,d4,d5,d6,d7,d8,d9,da,db,dc,dd,de,df,e0,e1,e2,e3,e4,e5,e6,e7,e8,e9,ea,eb,ec,ed,ee,ef,f0,f1,f2,f3,f4,f5,f6,f7,f8,f9,fa,fb,fc,fd,fe,ff".split(","),n="319705304701141539155720137200974664666792526059405792539680974929469783512821793995613718943171723765238853752439032835985158829038528214925658918372196742089464683960239919950882355844766055365179937610326127675178857306260955550407044463370239890187189750909036833976197804646589380690779463976173";function o(e){for(var r="",n=0,o=e.length;n<o;n++)r+=t[e[n]];return r}var i=function(e){var r=9007199254740992,t=s(r);function n(e,r,t,o){return void 0===e?n[0]:void 0!==r&&(10!=+r||t)?x(e,r,t,o):E(e)}function o(e,r){this.value=e,this.sign=r,this.isSmall=!1}function a(e){this.value=e,this.sign=e<0,this.isSmall=!0}function u(e){return-r<e&&e<r}function s(e){return e<1e7?[e]:e<1e14?[e%1e7,Math.floor(e/1e7)]:[e%1e7,Math.floor(e/1e7)%1e7,Math.floor(e/1e14)]}function l(e){f(e);var r=e.length;if(r<4&&N(e,t)<0)switch(r){case 0:return 0;case 1:return e[0];case 2:return e[0]+1e7*e[1];default:return e[0]+1e7*(e[1]+1e7*e[2])}return e}function f(e){for(var r=e.length;0===e[--r];);e.length=r+1}function h(e){for(var r=new Array(e),t=-1;++t<e;)r[t]=0;return r}function p(e){return e>0?Math.floor(e):Math.ceil(e)}function c(e,r){var t,n,o=e.length,i=r.length,a=new Array(o),u=0;for(n=0;n<i;n++)u=(t=e[n]+r[n]+u)>=1e7?1:0,a[n]=t-1e7*u;for(;n<o;)u=1e7===(t=e[n]+u)?1:0,a[n++]=t-1e7*u;return u>0&&a.push(u),a}function v(e,r){return e.length>=r.length?c(e,r):c(r,e)}function g(e,r){var t,n,o=e.length,i=new Array(o);for(n=0;n<o;n++)t=e[n]-1e7+r,r=Math.floor(t/1e7),i[n]=t-1e7*r,r+=1;for(;r>0;)i[n++]=r%1e7,r=Math.floor(r/1e7);return i}function d(e,r){var t,n,o=e.length,i=r.length,a=new Array(o),u=0;for(t=0;t<i;t++)(n=e[t]-u-r[t])<0?(n+=1e7,u=1):u=0,a[t]=n;for(t=i;t<o;t++){if(!((n=e[t]-u)<0)){a[t++]=n;break}n+=1e7,a[t]=n}for(;t<o;t++)a[t]=e[t];return f(a),a}function y(e,r,t){var n,i,u=e.length,s=new Array(u),f=-r;for(n=0;n<u;n++)i=e[n]+f,f=Math.floor(i/1e7),i%=1e7,s[n]=i<0?i+1e7:i;return"number"==typeof(s=l(s))?(t&&(s=-s),new a(s)):new o(s,t)}function m(e,r){var t,n,o,i,a=e.length,u=r.length,s=h(a+u);for(o=0;o<a;++o){i=e[o];for(var l=0;l<u;++l)t=i*r[l]+s[o+l],n=Math.floor(t/1e7),s[o+l]=t-1e7*n,s[o+l+1]+=n}return f(s),s}function w(e,r){var t,n,o=e.length,i=new Array(o),a=0;for(n=0;n<o;n++)t=e[n]*r+a,a=Math.floor(t/1e7),i[n]=t-1e7*a;for(;a>0;)i[n++]=a%1e7,a=Math.floor(a/1e7);return i}function b(e,r){for(var t=[];r-- >0;)t.push(0);return t.concat(e)}function A(e,r,t){return new o(e<1e7?w(r,e):m(r,s(e)),t)}function S(e){var r,t,n,o,i=e.length,a=h(i+i);for(n=0;n<i;n++){t=0-(o=e[n])*o;for(var u=n;u<i;u++)r=o*e[u]*2+a[n+u]+t,t=Math.floor(r/1e7),a[n+u]=r-1e7*t;a[n+i]=t}return f(a),a}function M(e,r){var t,n,o,i,a=e.length,u=h(a);for(o=0,t=a-1;t>=0;--t)o=(i=1e7*o+e[t])-(n=p(i/r))*r,u[t]=0|n;return[u,0|o]}function C(e,r){var t,i,u=E(r),c=e.value,v=u.value;if(0===v)throw new Error("Cannot divide by zero");if(e.isSmall)return u.isSmall?[new a(p(c/v)),new a(c%v)]:[n[0],e];if(u.isSmall){if(1===v)return[e,n[0]];if(-1==v)return[e.negate(),n[0]];var g=Math.abs(v);if(g<1e7){i=l((t=M(c,g))[0]);var y=t[1];return e.sign&&(y=-y),"number"==typeof i?(e.sign!==u.sign&&(i=-i),[new a(i),new a(y)]):[new o(i,e.sign!==u.sign),new a(y)]}v=s(g)}var m=N(c,v);if(-1===m)return[n[0],e];if(0===m)return[n[e.sign===u.sign?1:-1],n[0]];i=(t=c.length+v.length<=200?function(e,r){var t,n,o,i,a,u,s,f=e.length,p=r.length,c=h(r.length),v=r[p-1],g=Math.ceil(1e7/(2*v)),d=w(e,g),y=w(r,g);for(d.length<=f&&d.push(0),y.push(0),v=y[p-1],n=f-p;n>=0;n--){for(t=1e7-1,d[n+p]!==v&&(t=Math.floor((1e7*d[n+p]+d[n+p-1])/v)),o=0,i=0,u=y.length,a=0;a<u;a++)o+=t*y[a],s=Math.floor(o/1e7),i+=d[n+a]-(o-1e7*s),o=s,i<0?(d[n+a]=i+1e7,i=-1):(d[n+a]=i,i=0);for(;0!==i;){for(t-=1,o=0,a=0;a<u;a++)(o+=d[n+a]-1e7+y[a])<0?(d[n+a]=o+1e7,o=0):(d[n+a]=o,o=1);i+=o}c[n]=t}return d=M(d,g)[0],[l(c),l(d)]}(c,v):function(e,r){for(var t,n,o,i,a,u=e.length,s=r.length,h=[],p=[];u;)if(p.unshift(e[--u]),f(p),N(p,r)<0)h.push(0);else{o=1e7*p[(n=p.length)-1]+p[n-2],i=1e7*r[s-1]+r[s-2],n>s&&(o=1e7*(o+1)),t=Math.ceil(o/i);do{if(N(a=w(r,t),p)<=0)break;t--}while(t);h.push(t),p=d(p,a)}return h.reverse(),[l(h),l(p)]}(c,v))[0];var b=e.sign!==u.sign,A=t[1],S=e.sign;return"number"==typeof i?(b&&(i=-i),i=new a(i)):i=new o(i,b),"number"==typeof A?(S&&(A=-A),A=new a(A)):A=new o(A,S),[i,A]}function N(e,r){if(e.length!==r.length)return e.length>r.length?1:-1;for(var t=e.length-1;t>=0;t--)if(e[t]!==r[t])return e[t]>r[t]?1:-1;return 0}o.prototype=Object.create(n.prototype),a.prototype=Object.create(n.prototype),o.prototype.add=function(e){var r=E(e);if(this.sign!==r.sign)return this.subtract(r.negate());var t=this.value,n=r.value;return r.isSmall?new o(g(t,Math.abs(n)),this.sign):new o(v(t,n),this.sign)},o.prototype.plus=o.prototype.add,a.prototype.add=function(e){var r=E(e),t=this.value;if(t<0!==r.sign)return this.subtract(r.negate());var n=r.value;if(r.isSmall){if(u(t+n))return new a(t+n);n=s(Math.abs(n))}return new o(g(n,Math.abs(t)),t<0)},a.prototype.plus=a.prototype.add,o.prototype.subtract=function(e){var r=E(e);if(this.sign!==r.sign)return this.add(r.negate());var t=this.value,n=r.value;return r.isSmall?y(t,Math.abs(n),this.sign):function(e,r,t){var n;return N(e,r)>=0?n=d(e,r):(n=d(r,e),t=!t),"number"==typeof(n=l(n))?(t&&(n=-n),new a(n)):new o(n,t)}(t,n,this.sign)},o.prototype.minus=o.prototype.subtract,a.prototype.subtract=function(e){var r=E(e),t=this.value;if(t<0!==r.sign)return this.add(r.negate());var n=r.value;return r.isSmall?new a(t-n):y(n,Math.abs(t),t>=0)},a.prototype.minus=a.prototype.subtract,o.prototype.negate=function(){return new o(this.value,!this.sign)},a.prototype.negate=function(){var e=this.sign,r=new a(-this.value);return r.sign=!e,r},o.prototype.abs=function(){return new o(this.value,!1)},a.prototype.abs=function(){return new a(Math.abs(this.value))},o.prototype.multiply=function(e){var r,t,i,a=E(e),u=this.value,l=a.value,h=this.sign!==a.sign;if(a.isSmall){if(0===l)return n[0];if(1===l)return this;if(-1===l)return this.negate();if((r=Math.abs(l))<1e7)return new o(w(u,r),h);l=s(r)}return t=u.length,i=l.length,new o(-.012*t-.012*i+15e-6*t*i>0?function e(r,t){var n=Math.max(r.length,t.length);if(n<=30)return m(r,t);n=Math.ceil(n/2);var o=r.slice(n),i=r.slice(0,n),a=t.slice(n),u=t.slice(0,n),s=e(i,u),l=e(o,a),h=e(v(i,o),v(u,a)),p=v(v(s,b(d(d(h,s),l),n)),b(l,2*n));return f(p),p}(u,l):m(u,l),h)},o.prototype.times=o.prototype.multiply,a.prototype._multiplyBySmall=function(e){return u(e.value*this.value)?new a(e.value*this.value):A(Math.abs(e.value),s(Math.abs(this.value)),this.sign!==e.sign)},o.prototype._multiplyBySmall=function(e){return 0===e.value?n[0]:1===e.value?this:-1===e.value?this.negate():A(Math.abs(e.value),this.value,this.sign!==e.sign)},a.prototype.multiply=function(e){return E(e)._multiplyBySmall(this)},a.prototype.times=a.prototype.multiply,o.prototype.square=function(){return new o(S(this.value),!1)},a.prototype.square=function(){var e=this.value*this.value;return u(e)?new a(e):new o(S(s(Math.abs(this.value))),!1)},o.prototype.divmod=function(e){var r=C(this,e);return{quotient:r[0],remainder:r[1]}},a.prototype.divmod=o.prototype.divmod,o.prototype.divide=function(e){return C(this,e)[0]},a.prototype.over=a.prototype.divide=o.prototype.over=o.prototype.divide,o.prototype.mod=function(e){return C(this,e)[1]},a.prototype.remainder=a.prototype.mod=o.prototype.remainder=o.prototype.mod,o.prototype.modPow=function(e,r){if(e=E(e),(r=E(r)).isZero())throw new Error("Cannot take modPow with modulus 0");for(var t=n[1],o=this.mod(r);e.isPositive();){if(o.isZero())return n[0];e.isOdd()&&(t=t.multiply(o).mod(r)),e=e.divide(2),o=o.square().mod(r)}return t},a.prototype.modPow=o.prototype.modPow,o.prototype.compareAbs=function(e){var r=E(e),t=this.value,n=r.value;return r.isSmall?1:N(t,n)},a.prototype.compareAbs=function(e){var r=E(e),t=Math.abs(this.value),n=r.value;return r.isSmall?t===(n=Math.abs(n))?0:t>n?1:-1:-1},o.prototype.compare=function(e){if(e===1/0)return-1;if(e===-1/0)return 1;var r=E(e),t=this.value,n=r.value;return this.sign!==r.sign?r.sign?1:-1:r.isSmall?this.sign?-1:1:N(t,n)*(this.sign?-1:1)},o.prototype.compareTo=o.prototype.compare,a.prototype.compare=function(e){if(e===1/0)return-1;if(e===-1/0)return 1;var r=E(e),t=this.value,n=r.value;return r.isSmall?t==n?0:t>n?1:-1:t<0!==r.sign?t<0?-1:1:t<0?1:-1},a.prototype.compareTo=a.prototype.compare,o.prototype.equals=function(e){return 0===this.compare(e)},a.prototype.eq=a.prototype.equals=o.prototype.eq=o.prototype.equals,o.prototype.isOdd=function(){return 1==(1&this.value[0])},a.prototype.isOdd=function(){return 1==(1&this.value)},o.prototype.isPositive=function(){return!this.sign},a.prototype.isPositive=function(){return this.value>0},o.prototype.isNegative=function(){return this.sign},a.prototype.isNegative=function(){return this.value<0},o.prototype.isUnit=function(){return!1},a.prototype.isUnit=function(){return 1===Math.abs(this.value)},o.prototype.isZero=function(){return!1},a.prototype.isZero=function(){return 0===this.value},o.prototype.next=function(){var e=this.value;return this.sign?y(e,1,this.sign):new o(g(e,1),this.sign)},a.prototype.next=function(){var e=this.value;return e+1<r?new a(e+1):new o(t,!1)};var x=function(e,r,t,o){t=t||"0123456789abcdefghijklmnopqrstuvwxyz",e=String(e),o||(e=e.toLowerCase(),t=t.toLowerCase());var i,a=e.length,u=Math.abs(r),s={};for(i=0;i<t.length;i++)s[t[i]]=i;for(i=0;i<a;i++){if("-"!==(h=e[i])&&(h in s&&s[h]>=u)){if("1"===h&&1===u)continue;throw new Error(h+" is not a valid digit in base "+r+".")}}r=E(r);var l=[],f="-"===e[0];for(i=f?1:0;i<e.length;i++){var h;if((h=e[i])in s)l.push(E(s[h]));else{if("<"!==h)throw new Error(h+" is not a valid character");var p=i;do{i++}while(">"!==e[i]&&i<e.length);l.push(E(e.slice(p+1,i)))}}return function(e,r,t){var o,i=n[0],a=n[1];for(o=e.length-1;o>=0;o--)i=i.add(e[o].times(a)),a=a.times(r);return t?i.negate():i}(l,r,f)};function O(e,r,t){var n=function(e,r){if((r=i(r)).isZero()){if(e.isZero())return{value:[0],isNegative:!1};throw new Error("Cannot convert nonzero numbers to base 0.")}if(r.equals(-1)){if(e.isZero())return{value:[0],isNegative:!1};if(e.isNegative())return{value:[].concat.apply([],Array.apply(null,Array(-e.toJSNumber())).map(Array.prototype.valueOf,[1,0])),isNegative:!1};var t=Array.apply(null,Array(e.toJSNumber()-1)).map(Array.prototype.valueOf,[0,1]);return t.unshift([1]),{value:[].concat.apply([],t),isNegative:!1}}var n=!1;if(e.isNegative()&&r.isPositive()&&(n=!0,e=e.abs()),r.isUnit())return e.isZero()?{value:[0],isNegative:!1}:{value:Array.apply(null,Array(e.toJSNumber())).map(Number.prototype.valueOf,1),isNegative:n};for(var o,a=[],u=e;u.isNegative()||u.compareAbs(r)>=0;){o=u.divmod(r),u=o.quotient;var s=o.remainder;s.isNegative()&&(s=r.minus(s).abs(),u=u.next()),a.push(s.toJSNumber())}return a.push(u.toJSNumber()),{value:a.reverse(),isNegative:n}}(e,r);return(n.isNegative?"-":"")+n.value.map((function(e){return function(e,r){return e<(r=r||"0123456789abcdefghijklmnopqrstuvwxyz").length?r[e]:"<"+e+">"}(e,t)})).join("")}function P(e){if(u(+e)){var r=+e;if(r===p(r))return new a(r);throw new Error("Invalid integer: "+e)}var t="-"===e[0];t&&(e=e.slice(1));var n=e.split(/e/i);if(n.length>2)throw new Error("Invalid integer: "+n.join("e"));if(2===n.length){var i=n[1];if("+"===i[0]&&(i=i.slice(1)),(i=+i)!==p(i)||!u(i))throw new Error("Invalid integer: "+i+" is not a valid exponent.");var s=n[0],l=s.indexOf(".");if(l>=0&&(i-=s.length-l-1,s=s.slice(0,l)+s.slice(l+1)),i<0)throw new Error("Cannot include negative exponent part for integers");e=s+=new Array(i+1).join("0")}if(!/^([0-9][0-9]*)$/.test(e))throw new Error("Invalid integer: "+e);for(var h=[],c=e.length,v=c-7;c>0;)h.push(+e.slice(v,c)),(v-=7)<0&&(v=0),c-=7;return f(h),new o(h,t)}function E(e){return"number"==typeof e?function(e){if(u(e)){if(e!==p(e))throw new Error(e+" is not an integer.");return new a(e)}return P(e.toString())}(e):"string"==typeof e?P(e):e}o.prototype.toString=function(e,r){if(void 0===e&&(e=10),10!==e)return O(this,e,r);for(var t,n=this.value,o=n.length,i=String(n[--o]);--o>=0;)t=String(n[o]),i+="0000000".slice(t.length)+t;return(this.sign?"-":"")+i},a.prototype.toString=function(e,r){return void 0===e&&(e=10),10!=e?O(this,e,r):String(this.value)},o.prototype.valueOf=function(){return parseInt(this.toString(),10)},o.prototype.toJSNumber=o.prototype.valueOf,a.prototype.valueOf=function(){return this.value},a.prototype.toJSNumber=a.prototype.valueOf;for(var U=0;U<1e3;U++)n[U]=E(U),U>0&&(n[-U]=E(-U));return n}();function a(r,t){return i(t).modPow(e.number_hash(r,100),n).toString()}return e.number_hash=function(e,r){r=r&&!isNaN(r)&&isFinite(r)&&r>0?r:10;for(var t="",n=0,o=0,i="",a=void 0,u=void 0;t.length<r;n++){for(a=0,u=e.length;a<u;a++)o=(o<<5)-o+e.charCodeAt(a),o|=0;for(i=String(o+Math.pow(2,31));i.length<10;)i="0"+o;t+=i.slice(2)}return t.slice(0,r)},e.rand=function(r,t){function n(){return String(Math.floor(Math.random()*(Math.pow(10,16)-1-Math.pow(10,15)+1)+Math.pow(10,15))).slice(3,15)}var o=r&&!isNaN(r)&&isFinite(r)&&r>0?r:8,i=t?String(t):n(),a=0,u="",s="";for(o>300&&(o=300);s.length<o;){a=Number(n());for(var l=0;l<4300;l++)a+=Number(String((new Date).getTime()).slice(7));for(u=String(a);"0"===u.charAt(0)&&u.length>1;)u=u.slice(1);s+=u=e.number_hash(i+u,8)}for(;"0"===s.charAt(0)&&s.length>1;)s=s.slice(1);return s.length<o?e.rand(o,i+n()):s.slice(0,o)},e.hash=function(e,r){function t(e){return"undefined"!=typeof Uint8Array?new Uint8Array(e):new Array(e)}function n(e){return"undefined"!=typeof Int32Array?new Int32Array(e):new Array(e)}var i=1779033703,a=3144134277,u=1013904242,s=2773480762,l=1359893119,f=2600822924,h=528734635,p=1541459225,c=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];e=e||"",e=String(e.length+1231)+String(e);var v,g=unescape(encodeURIComponent(e)),d=t(g.length);for(v=0;v<g.length;v++)d[v]=255&g.charCodeAt(v);var y=d.length,m=64*Math.floor((y+72)/64),w=m/4,b=8*y,A=t(m);if("undefined"==typeof Uint8Array||Array.isArray(A)){for(v=0;v<d.length;v++)A[v]=d[v];for(v=d.length;v<A.length;v++)A[v]=0}else A.set(d);A[y]=128,A[m-4]=b>>>24,A[m-3]=b>>>16&255,A[m-2]=b>>>8&255,A[m-1]=255&b;var S,M=n(w),C=0;for(v=0;v<M.length;v++)S=A[C]<<24,S|=A[C+1]<<16,S|=A[C+2]<<8,S|=A[C+3],M[v]=S,C+=4;S=null,C=null;for(var N,x,O,P,E,U,K,k,j,q,I,_,D,J=n(64),Z=0;Z<w;Z+=16){for(v=0;v<16;v++)J[v]=M[Z+v];for(v=16;v<64;v++)x=(N=J[v-15])>>>7|N<<25,x^=N>>>18|N<<14,x^=N>>>3,O=(N=J[v-2])>>>17|N<<15,O^=N>>>19|N<<13,O^=N>>>10,J[v]=J[v-16]+x+J[v-7]+O&4294967295;for(P=i,E=a,U=u,K=s,k=l,j=f,q=h,I=p,v=0;v<64;v++)O=k>>>6|k<<26,O^=k>>>11|k<<21,_=I+(O^=k>>>25|k<<7)+(k&j^~k&q)+c[v]+J[v]&4294967295,x=P>>>2|P<<30,x^=P>>>13|P<<19,D=P&E^P&U^E&U,I=q,q=j,j=k,k=K+_&4294967295,K=U,U=E,E=P,P=_+((x^=P>>>22|P<<10)+D&4294967295)&4294967295;i=i+P&4294967295,a=a+E&4294967295,u=u+U&4294967295,s=s+K&4294967295,l=l+k&4294967295,f=f+j&4294967295,h=h+q&4294967295,p=p+I&4294967295}var V=t(32);for(v=0;v<4;v++)V[v]=i>>>8*(3-v)&255,V[v+4]=a>>>8*(3-v)&255,V[v+8]=u>>>8*(3-v)&255,V[v+12]=s>>>8*(3-v)&255,V[v+16]=l>>>8*(3-v)&255,V[v+20]=f>>>8*(3-v)&255,V[v+24]=h>>>8*(3-v)&255,V[v+28]=p>>>8*(3-v)&255;return r?V:o(V)},e.hmac=function(r,t){var n;if((t=String(t)).length>32)n=e.hash(t,!0);else{var i=unescape(encodeURIComponent(t));n=new Uint8Array(32);for(var a=0;a<i.length;a++)n[a]=i.charCodeAt(a)}for(a=0;a<n.length;a++)n[a]^=54;var u=e.hash(o(n));for(a=0;a<n.length;a++)n[a]^=106;return e.hash(o(n)+u+String(r))},e.write=function(t,n){if(null===t)return"";if(t=function(e){if(null===e)return"";var t,n,o,i,a,u,s,l,f,h,p="",c=e,v={},g={},d="",y="",m="",w=2,b=3,A=2,S="",M=0,C=0,N=String.fromCharCode;for(h=0;h<e.length;h+=1)if(d=e.charAt(h),Object.prototype.hasOwnProperty.call(v,d)||(v[d]=b++,g[d]=!0),y=m+d,Object.prototype.hasOwnProperty.call(v,y))m=y;else{if(Object.prototype.hasOwnProperty.call(g,m)){if(m.charCodeAt(0)<256){for(l=0;l<A;l++)M<<=1,15===C?(C=0,S+=N(M),M=0):C++;for(f=m.charCodeAt(0),l=0;l<8;l++)M=M<<1|1&f,15===C?(C=0,S+=N(M),M=0):C++,f>>=1}else{for(f=1,l=0;l<A;l++)M=M<<1|f,15===C?(C=0,S+=N(M),M=0):C++,f=0;for(f=m.charCodeAt(0),l=0;l<16;l++)M=M<<1|1&f,15===C?(C=0,S+=N(M),M=0):C++,f>>=1}0===--w&&(w=Math.pow(2,A),A++),delete g[m]}else for(f=v[m],l=0;l<A;l++)M=M<<1|1&f,15===C?(C=0,S+=N(M),M=0):C++,f>>=1;0===--w&&(w=Math.pow(2,A),A++),v[y]=b++,m=String(d)}if(""!==m){if(Object.prototype.hasOwnProperty.call(g,m)){if(m.charCodeAt(0)<256){for(l=0;l<A;l++)M<<=1,15===C?(C=0,S+=N(M),M=0):C++;for(f=m.charCodeAt(0),l=0;l<8;l++)M=M<<1|1&f,15===C?(C=0,S+=N(M),M=0):C++,f>>=1}else{for(f=1,l=0;l<A;l++)M=M<<1|f,15===C?(C=0,S+=N(M),M=0):C++,f=0;for(f=m.charCodeAt(0),l=0;l<16;l++)M=M<<1|1&f,15===C?(C=0,S+=N(M),M=0):C++,f>>=1}0===--w&&(w=Math.pow(2,A),A++),delete g[m]}else for(f=v[m],l=0;l<A;l++)M=M<<1|1&f,15===C?(C=0,S+=N(M),M=0):C++,f>>=1;0===--w&&(w=Math.pow(2,A),A++)}for(f=2,l=0;l<A;l++)M=M<<1|1&f,15===C?(C=0,S+=N(M),M=0):C++,f>>=1;for(;;){if(M<<=1,15===C){S+=N(M);break}C++}function x(e){for(var l=0;l<2*e.length;)l%2==0?(t=e.charCodeAt(l/2)>>8,n=255&e.charCodeAt(l/2),o=l/2+1<e.length?e.charCodeAt(l/2+1)>>8:NaN):(t=255&e.charCodeAt((l-1)/2),(l+1)/2<e.length?(n=e.charCodeAt((l+1)/2)>>8,o=255&e.charCodeAt((l+1)/2)):n=o=NaN),l+=3,i=t>>2,a=(3&t)<<4|n>>4,u=(15&n)<<2|o>>6,s=63&o,isNaN(n)?u=s=64:isNaN(o)&&(s=64),p=p+r.charAt(i)+r.charAt(a)+r.charAt(u)+r.charAt(s);return p}var O=x("l"+S);return c=x("n"+c),O.length>c.length&&(O=c),"b"+O}(t=String(t)),n){var o,i,a=[],u=r,s=e.hash(n),l=u+u+u+u+u;for(o=0,i=0;o<t.length;o++,i=i===String(s).length-1?0:i+1)a[o]=l[u.indexOf(t[o])+4*u.indexOf(String(s)[i])];t="d"+a.join(""),o=null,a=null,u=null,s=null,i=null,l=null,n=null}return t},e.read=function(t,n){if(null===t)return"";if(t=String(t),n&&/^d/.test(t)){var o,i,a=(t=t.replace(/^d/,"")).length,u=[],s=r,l=e.hash(n),f=s+s+s+s+s,h=String(l).length,p=s.length;for(i=0,o=0;i<a;i++,o=o===h-1?0:o+1)u[i]=f[s.indexOf(t[i])+4*p-4*s.indexOf(String(l)[o])];t=u.join(""),n=null,a=null,u=null,s=null,l=null,o=null,f=null,i=null}return function(e){if(null===e)return console.log("Decompression error1: Input is null"),"";if(!/^b/.test(e))return null;e=e.replace(/^b/,"");var t,n,o,i,a,u,s="",l=0,f=0,h=0,p=String.fromCharCode;for(e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");h<e.length;)t=r.indexOf(e.charAt(h++))<<2|(i=r.indexOf(e.charAt(h++)))>>4,n=(15&i)<<4|(a=r.indexOf(e.charAt(h++)))>>2,o=(3&a)<<6|(u=r.indexOf(e.charAt(h++))),l%2==0?(f=t<<8,64!==a&&(s+=p(f|n)),64!==u&&(f=o<<8)):(s+=p(f|t),64!==a&&(f=n<<8),64!==u&&(s+=p(f|o))),l+=3;if(l=null,f=null,t=null,n=null,o=null,null,i=null,a=null,u=null,!/^l/.test(s))return s.replace(/^n/,"");var c=s.replace(/^l/,"");if(s=null,null===c)return console.log("Decompression error2: Reverted from Base64 value is null"),null;if(""===c)return console.log('Decompression error3: Reverted from Base64 value is "" (Empty string)'),null;for(var v,g,d,y=[0,1,2,3],m=4,w=4,b=3,A="",S="",M=0,C=4,N=1,x={string:c,val:c.charCodeAt(0),position:32768,index:1};N!=C;)g=x.val&x.position,x.position>>=1,0===x.position&&(x.position=32768,x.val=x.string.charCodeAt(x.index++)),M|=(g>0?1:0)*N,N<<=1;switch(M){case 0:for(M=0,C=Math.pow(2,8),N=1;N!=C;)g=x.val&x.position,x.position>>=1,0===x.position&&(x.position=32768,x.val=x.string.charCodeAt(x.index++)),M|=(g>0?1:0)*N,N<<=1;d=p(M);break;case 1:for(M=0,C=Math.pow(2,16),N=1;N!=C;)g=x.val&x.position,x.position>>=1,0===x.position&&(x.position=32768,x.val=x.string.charCodeAt(x.index++)),M|=(g>0?1:0)*N,N<<=1;d=p(M);break;case 2:return""}for(y[3]=d,v=S=d;;){if(x.index>x.string.length)return console.log("Decompression error5"),"";for(M=0,C=Math.pow(2,b),N=1;N!=C;)g=x.val&x.position,x.position>>=1,0===x.position&&(x.position=32768,x.val=x.string.charCodeAt(x.index++)),M|=(g>0?1:0)*N,N<<=1;switch(d=M){case 0:for(M=0,C=Math.pow(2,8),N=1;N!=C;)g=x.val&x.position,x.position>>=1,0===x.position&&(x.position=32768,x.val=x.string.charCodeAt(x.index++)),M|=(g>0?1:0)*N,N<<=1;y[w++]=p(M),d=w-1,m--;break;case 1:for(M=0,C=Math.pow(2,16),N=1;N!=C;)g=x.val&x.position,x.position>>=1,0===x.position&&(x.position=32768,x.val=x.string.charCodeAt(x.index++)),M|=(g>0?1:0)*N,N<<=1;y[w++]=p(M),d=w-1,m--;break;case 2:return S}if(0===m&&(m=Math.pow(2,b),b++),y[d])A=y[d];else{if(d!==w||!v)return null;A=v+v.charAt(0)}S+=A,y[w++]=v+A.charAt(0),v=A,0===--m&&(m=Math.pow(2,b),b++)}}(t)},e.write_and_verify=function(r,t){var n=r;return r=e.write(r,t),e.read(r,t)!==n?"Write error! Aborted operation. "+function(e,r){var t=[],n=1;if(null===r)return"Decompressing the string returned null. Possibly invalid key used??";var o=e.length,i=r.length;t[0]=o!==i?"Strings are not the same length. String 1: "+o+" characters. String 2: "+i+" characters.":"Entire text length: "+o+" characters";for(var a=0;a<o&&a<i;a++)e.charAt(a)!==r.charAt(a)&&(t[n]="Char "+(a+1)+": ASCII "+e.charCodeAt(a)+" not equal to ",t[n]=t[n]+"ASCII "+r.charCodeAt(a)+".",t[n]=t[n]+"Surrounding text: "+e.slice(a-10,a+10),n++);return 1!==n&&t.join("<br />")}(n,e.read(r,t)):r},e.createPublicKey=function(r){return r=e.number_hash(r,100),i("32416178251").modPow(r,n).toString()},e.createUserKey=function(r,t){return e.write("key:"+t,a(t,r))},e.createUserKey_and_verify=function(r,t){var n=e.createPublicKey(t),o=e.createPublicKey(r),i=a(r,n),u=a(t,o);if(i!==u)throw new Error("Public/Private key creation error");var s=e.write_and_verify("key:"+t,u);if(String(t)===String(e.readUserKey(r,s,n)))return s;throw new Error("Error creating user key for "+r)},e.readUserKey=function(r,t,n){var o=e.read(t,a(r,n));return!!/^key:/.test(o)&&o.replace(/^key:/,"")},e.share=function(r,t,o,i){var a=e.rand(n.length),u=[e.createUserKey(e.createPublicKey(t),a)];if(i=i&&!isNaN(i)&&isFinite(i)?(new Date).getTime()+26298e5*i:!!i&&(new Date).getTime()+473364e5,r=e.write(r,a),o&&o instanceof Array)for(var s=0;s<o.length;s++)u[s+1]=e.createUserKey(o[s],a);return{Version:e.Version,Expires:i,Compressed:!0,Data:r,PublicKey:e.createPublicKey(a),UserKeys:e.write_and_verify(JSON.stringify(u)),Signature:e.hmac(r+i,a)}},e.readShared=function(r,t){var n,o,i,a="error",u="";if(r.Version===e.Version||1===r.Version){if(r.UserKeys&&r.Compressed){for(var s=JSON.parse(e.read(r.UserKeys)),l=0,f=s.length;l<f;l++)e.readUserKey(t,s[l],r.PublicKey)&&(n=e.readUserKey(t,s[l],r.PublicKey));s=null}!1!==r.Expires&&(new Date).getTime()>r.Expires?u="data expired":n?1===r.Version?(o=e.read(r.Data,n),i=e.hash(o+r.Expires),r.Signature===i?(a="results",u="success"):(o=null,u="hash didn't match")):(i=e.hmac(r.Data+r.Expires,n),r.Signature===i?(o=e.read(r.Data,n),a="results",u="success"):(o=null,u="hmac didn't match")):u="no key match"}else u="file version '"+r.Version+"' not supported";return{type:a,message:u,data:o,hmac:i}},e}();