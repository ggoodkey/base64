/*!
* Base64 performs several functions: 
* Compress a string to base64, Diffie Hellman Merkle key exchange, 
* SHA256 hash, and generate high entropy random numbers.
* Generated public Keys are numeric and 300 digits in length (~1000 bit equivelent).
* 
* Last Modified: October 9, 2017
* Copyright (C) 2017 Graeme Goodkey github.com/ggoodkey
* All rights reserved
* 
* Released free of charge for inclusion in your own applications, as is or as modified by you.
* DISTRIBUTED "AS IS", WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND.
* 
* Converting to Base 64 is based on Vassilis Petroulias' base64v1_0.js
* http://jsbase64.codeplex.com/
* 
* Compression is based on Sam Hocevar's lz-string-1.3.3.js 
* http://pieroxy.net/blog/pages/lz-string/index.html
* 
* Handling big integers is a subset of BigInteger.js by peterolson 
* https://www.npmjs.com/package/big-integer/
* 
*/
var Base64={};(function(){function r(t){function et(t){for(var i=0;i<t.length*2;)i%2==0?(b=t.charCodeAt(i/2)>>8,a=t.charCodeAt(i/2)&255,l=i/2+1<t.length?t.charCodeAt(i/2+1)>>8:NaN):(b=t.charCodeAt((i-1)/2)&255,(i+1)/2<t.length?(a=t.charCodeAt((i+1)/2)>>8,l=t.charCodeAt((i+1)/2)&255):a=l=NaN),i+=3,rt=b>>2,ut=(b&3)<<4|a>>4,it=(a&15)<<2|l>>6,k=l&63,isNaN(a)?it=k=64:isNaN(l)&&(k=64),tt=tt+n.charAt(rt)+n.charAt(ut)+n.charAt(it)+n.charAt(k);return tt}var nt;if(t===null)return"";for(var tt="",w=t,b,a,l,rt,ut,it,k,f,u,v={},p={},y="",d="",e="",h=2,ft=3,o=2,s="",i=0,r=0,c=String.fromCharCode,g=0;g<t.length;g+=1)if(y=t.charAt(g),Object.prototype.hasOwnProperty.call(v,y)||(v[y]=ft++,p[y]=!0),d=e+y,Object.prototype.hasOwnProperty.call(v,d))e=d;else{if(Object.prototype.hasOwnProperty.call(p,e)){if(e.charCodeAt(0)<256){for(f=0;f<o;f++)i=i<<1,r===15?(r=0,s+=c(i),i=0):r++;for(u=e.charCodeAt(0),f=0;f<8;f++)i=i<<1|u&1,r===15?(r=0,s+=c(i),i=0):r++,u=u>>1}else{for(u=1,f=0;f<o;f++)i=i<<1|u,r===15?(r=0,s+=c(i),i=0):r++,u=0;for(u=e.charCodeAt(0),f=0;f<16;f++)i=i<<1|u&1,r===15?(r=0,s+=c(i),i=0):r++,u=u>>1}h--;h===0&&(h=Math.pow(2,o),o++);delete p[e]}else for(u=v[e],f=0;f<o;f++)i=i<<1|u&1,r===15?(r=0,s+=c(i),i=0):r++,u=u>>1;h--;h===0&&(h=Math.pow(2,o),o++);v[d]=ft++;e=String(y)}if(e!==""){if(Object.prototype.hasOwnProperty.call(p,e)){if(e.charCodeAt(0)<256){for(f=0;f<o;f++)i=i<<1,r===15?(r=0,s+=c(i),i=0):r++;for(u=e.charCodeAt(0),f=0;f<8;f++)i=i<<1|u&1,r===15?(r=0,s+=c(i),i=0):r++,u=u>>1}else{for(u=1,f=0;f<o;f++)i=i<<1|u,r===15?(r=0,s+=c(i),i=0):r++,u=0;for(u=e.charCodeAt(0),f=0;f<16;f++)i=i<<1|u&1,r===15?(r=0,s+=c(i),i=0):r++,u=u>>1}h--;h===0&&(h=Math.pow(2,o),o++);delete p[e]}else for(u=v[e],f=0;f<o;f++)i=i<<1|u&1,r===15?(r=0,s+=c(i),i=0):r++,u=u>>1;h--;h===0&&(h=Math.pow(2,o),o++)}for(u=2,f=0;f<o;f++)i=i<<1|u&1,r===15?(r=0,s+=c(i),i=0):r++,u=u>>1;for(;;)if(i=i<<1,r===15){s+=c(i);break}else r++;return nt=et("l"+s),w=et("n"+w),nt.length>w.length&&(nt=w),"b"+nt}function u(t){var b;if(t===null)return console.log("Decompression error1: Input is null"),"";if(/^b/.test(t))t=t.replace(/^b/,"");else return null;var c="",ft=0,v,nt,tt,it,et,rt,w,g,o=0,h=String.fromCharCode;for(t=t.replace(/[^A-Za-z0-9\+\/\=]/g,"");o<t.length;)et=n.indexOf(t.charAt(o++)),rt=n.indexOf(t.charAt(o++)),w=n.indexOf(t.charAt(o++)),g=n.indexOf(t.charAt(o++)),nt=et<<2|rt>>4,tt=(rt&15)<<4|w>>2,it=(w&3)<<6|g,ft%2==0?(v=nt<<8,w!==64&&(c+=h(v|tt)),g!==64&&(v=it<<8)):(c=c+h(v|nt),w!==64&&(v=tt<<8),g!==64&&(c+=h(v|it))),ft+=3;if(/^l/.test(c))b=c.replace(/^l/,"");else return c.replace(/^n/,"");if(b===null)return console.log("Decompression error2: Reverted from Base64 value is null"),null;if(b==="")return console.log('Decompression error3: Reverted from Base64 value is "" (Empty string)'),null;var l=[],ot,a=4,y=4,k=3,d="",ut="",p,u,f,e,r,s,i={string:b,val:b.charCodeAt(0),position:32768,index:1};for(h=String.fromCharCode,o=0;o<3;o+=1)l[o]=o;for(u=0,e=Math.pow(2,2),r=1;r!=e;)f=i.val&i.position,i.position>>=1,i.position===0&&(i.position=32768,i.val=i.string.charCodeAt(i.index++)),u|=(f>0?1:0)*r,r<<=1;switch(ot=u){case 0:for(u=0,e=Math.pow(2,8),r=1;r!=e;)f=i.val&i.position,i.position>>=1,i.position===0&&(i.position=32768,i.val=i.string.charCodeAt(i.index++)),u|=(f>0?1:0)*r,r<<=1;s=h(u);break;case 1:for(u=0,e=Math.pow(2,16),r=1;r!=e;)f=i.val&i.position,i.position>>=1,i.position===0&&(i.position=32768,i.val=i.string.charCodeAt(i.index++)),u|=(f>0?1:0)*r,r<<=1;s=h(u);break;case 2:return""}for(l[3]=s,p=ut=s;;){if(i.index>i.string.length)return console.log("Decompression error5"),"";for(u=0,e=Math.pow(2,k),r=1;r!=e;)f=i.val&i.position,i.position>>=1,i.position===0&&(i.position=32768,i.val=i.string.charCodeAt(i.index++)),u|=(f>0?1:0)*r,r<<=1;switch(s=u){case 0:for(u=0,e=Math.pow(2,8),r=1;r!=e;)f=i.val&i.position,i.position>>=1,i.position===0&&(i.position=32768,i.val=i.string.charCodeAt(i.index++)),u|=(f>0?1:0)*r,r<<=1;l[y++]=h(u);s=y-1;a--;break;case 1:for(u=0,e=Math.pow(2,16),r=1;r!=e;)f=i.val&i.position,i.position>>=1,i.position===0&&(i.position=32768,i.val=i.string.charCodeAt(i.index++)),u|=(f>0?1:0)*r,r<<=1;l[y++]=h(u);s=y-1;a--;break;case 2:return ut}if(a===0&&(a=Math.pow(2,k),k++),l[s])d=l[s];else if(s===y&&p)d=p+p.charAt(0);else return null;ut+=d;l[y++]=p+d.charAt(0);a--;p=d;a===0&&(a=Math.pow(2,k),k++)}}var t=function(){function n(n,t){this.value=n;this.sign=t}function f(n){while(n[n.length-1]===0&&n.length>1)n.pop();return n}function e(n,i){for(var e,f=[],r=0,u=0;u<n.length;u++)r+=i*n[u],e=Math.floor(r/t),f[u]=r-e*t|0,r=e;return f[n.length]=r|0,f}function o(n,i){for(var f=[],u,e,o,r=0;r<n.length;r++)f[r]=0;for(u=0,r=n.length-1;r>=0;r--)e=u*t+n[r],o=Math.floor(e/i),u=e-o*i,f[r]=o|0;return{quotient:f,remainder:u|0}}function s(i){return(typeof i=="number"||typeof i=="string")&&+Math.abs(i)<=t||i instanceof n&&i.value.length<=1}function u(r){var s,h,c,e,o,a,l;if(r instanceof n)return r;if(Math.abs(+r)<t&&+r==(+r|0))return s=+r,new n([Math.abs(s)],s<0||1/s==-Infinity);if(r+="",h=i.positive,c=[],r[0]==="-"&&(h=i.negative,r=r.slice(1)),r=r.split(/e/i),r.length>2)throw new Error("Invalid integer: "+r.join("e"));if(r[1]){if(e=r[1],e[0]==="+"&&(e=e.slice(1)),e=u(e),o=r[0].indexOf("."),o>=0&&(e=e.minus(r[0].length-o),r[0]=r[0].slice(0,o)+r[0].slice(o+1)),e.lesser(0))throw new Error("Cannot include negative exponent part for integers");while(e.notEquals(0))r[0]+="0",e=e.prev()}if(r=r[0],r==="-0"&&(r="0"),a=/^([0-9][0-9]*)$/.test(r),!a)throw new Error("Invalid integer: "+r);while(r.length)l=r.length>7?r.length-7:0,c.push(+r.slice(l)),r=r.slice(0,l);return new n(f(c),h)}var t=1e7,i={positive:!1,negative:!0},r,h;return n.prototype.multiply=function(i){var h,o,r,c,a,v,l;if(s(i))return h=this,o=+i,c=e(h.value,o<0?-o:o),new n(f(c),o<0?!h.sign:h.sign);for(i=u(i),a=this.sign!==i.sign,h=this.value,o=i.value,c=[],r=h.length+o.length;r>0;r--)c.push(0);for(r=0;r<h.length;r++)for(v=h[r],l=0;l<o.length;l++){var w=o[l],y=v*w+c[r+l],p=Math.floor(y/t);c[r+l]=y-p*t;c[r+l+1]+=p}return new n(f(c),a)},n.prototype.divmod=function(h){var w,l,b,c,it,a,d,v,p,tt;if(s(h)){if(w=this,l=+h,l===0)throw new Error("Cannot divide by zero.");return b=o(w.value,l<0?-l:l),{quotient:new n(f(b.quotient),l<0?!w.sign:w.sign),remainder:new n([b.remainder],w.sign)}}if(h=u(h),it=this.sign!==h.sign,h.equals(r))throw new Error("Cannot divide by zero");if(this.equals(r))return{quotient:new n([0],i.positive),remainder:new n([0],i.positive)};for(w=this.value,l=h.value,b=[0],c=0;c<l.length;c++)b[c]=0;var g=l[l.length-1],nt=Math.ceil(t/2/g),y=e(w,nt),k=e(l,nt);for(g=k[l.length-1],a=w.length-l.length;a>=0;a--){for(d=t-1,y[a+l.length]!==g&&(d=Math.floor((y[a+l.length]*t+y[a+l.length-1])/g)),v=0,p=0,c=0;c<k.length;c++)v+=d*k[c],tt=Math.floor(v/t),p+=y[a+c]-(v-tt*t),v=tt,p<0?(y[a+c]=p+t|0,p=-1):(y[a+c]=p|0,p=0);while(p!==0){for(d-=1,v=0,c=0;c<k.length;c++)v+=y[a+c]-t+k[c],v<0?(y[a+c]=v+t|0,v=0):(y[a+c]=v|0,v=1);p+=v}b[a]=d|0}return y=o(y,nt).quotient,{quotient:new n(f(b),it),remainder:new n(f(y),this.sign)}},n.prototype.modPow=function(n,t){if(n=u(n),t=u(t),t.equals(r))throw new Error("Cannot take modPow with modulus 0");var f=h,i=this.divmod(t).remainder;if(i.equals(r))return r;while(n.compare(0)>0)n.isOdd()&&(f=f.multiply(i).divmod(t).remainder),n=n.divmod(2).quotient,i=i.multiply(i).divmod(t).remainder;return f},n.prototype.compare=function(n){var t=this,f=u(n),r,e,o;if(t.value.length===1&&f.value.length===1&&t.value[0]===0&&f.value[0]===0)return 0;if(f.sign!==t.sign)return t.sign===i.positive?1:-1;var s=t.sign===i.positive?1:-1,h=t.value,c=f.value,l=Math.max(h.length,c.length)-1;for(r=l;r>=0;r--){if(e=h[r]||0,o=c[r]||0,e>o)return 1*s;if(o>e)return-1*s}return 0},n.prototype.equals=function(n){return this.compare(n)===0},n.prototype.isOdd=function(){return this.value[0]%2==1},n.prototype.toString=function(n){var f,e;if(n===undefined&&(n=10),n!==10)return toBase(this,n);var r=this,u="",t=r.value.length;if(t===0||t===1&&r.value[0]===0)return"0";for(t-=1,u=r.value[t].toString();--t>=0;)f=r.value[t].toString(),u+="0000000".slice(f.length)+f;return e=r.sign===i.positive?"":"-",e+u},r=new n([0],i.positive),h=new n([1],i.positive),function(n){return typeof n=="undefined"?r:u(n)}}();const n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",i="319705304701141539155720137200974664666792526059405792539680974929469783512821793995613718943171723765238853752439032835985158829038528214925658918372196742089464683960239919950882355844766055365179937610326127675178857306260955550407044463370239890187189750909036833976197804646589380690779463976173";Base64.Version=1;Base64.number_hash=function(n,t){var r,f,i,u,e,o;for(t=!isNaN(parseFloat(t))&&isFinite(t)&&t>0?parseInt(t):10,n=Base64.hash(n),r="",f=0;r.length<t;f++){if(i=0,n.length===0)return i;for(u=0,o=n.length;u<o;u++)e=n.charCodeAt(u),i=(i<<5)-i+e|0;for(i=String(i+Math.pow(2,31));i.length<10;)i="0"+i;r+=i.slice(2)}return r.slice(0,t)};Base64.rand=function(n,t){var u=!isNaN(parseFloat(n))&&isFinite(n)&&n>0?parseInt(n,10):8,e=t?String(t):String(Math.random()),i=0,r="",f;for(u>300&&(u=300);r.length<u;){for(i=0,f=0;f<4300;f++)i+=Number(String((new Date).getTime()).slice(7));for(i=String(i);i.charAt(0)==="0"&&i.length>1;)i=i.slice(1);i=Base64.number_hash(e+i,8);r+=i}while(r.charAt(0)==="0"&&r.length>1)r=r.slice(1);return r.length<u?Base64.rand(u,e+Math.random()):r.slice(0,u)};Base64.hash=function(n,t){function ht(n){return typeof Uint8Array!="undefined"?new Uint8Array(n):new Array(n)}function pt(n){return typeof Int32Array!="undefined"?new Int32Array(n):new Array(n)}var w=1779033703,b=3144134277,k=1013904242,d=2773480762,g=1359893119,nt=2600822924,tt=528734635,it=1541459225,ni=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],rt,i,ft,a,v,s,et,u,h,c,bt,vt,kt,dt,f,yt,gt;if(n=n?n:"",n=String(n.length+1231)+String(n),typeof n=="string")for(rt=unescape(encodeURIComponent(n)),n=ht(rt.length),i=0;i<rt.length;i++)n[i]=rt.charCodeAt(i)&255;var ct=n.length,l=Math.floor((ct+72)/64)*64,wt=l/4,ut=ct*8,r=ht(l);if(typeof Uint8Array!="undefined")r.set(n);else{for(i=0;i<n.length;i++)r[i]=n[i];for(i=n.length;i<r.length;i++)r[i]=0}for(r[ct]=128,r[l-4]=ut>>>24,r[l-3]=ut>>>16&255,r[l-2]=ut>>>8&255,r[l-1]=ut&255,ft=pt(wt),a=0,i=0;i<ft.length;i++)v=r[a]<<24,v|=r[a+1]<<16,v|=r[a+2]<<8,v|=r[a+3],ft[i]=v,a+=4;for(s=pt(64),et=0;et<wt;et+=16){for(i=0;i<16;i++)s[i]=ft[et+i];for(i=16;i<64;i++)u=s[i-15],h=u>>>7|u<<25,h^=u>>>18|u<<14,h^=u>>>3,u=s[i-2],c=u>>>17|u<<15,c^=u>>>19|u<<13,c^=u>>>10,s[i]=s[i-16]+h+s[i-7]+c&4294967295;var e=w,y=b,p=k,lt=d,o=g,ot=nt,st=tt,at=it;for(i=0;i<64;i++)c=o>>>6|o<<26,c^=o>>>11|o<<21,c^=o>>>25|o<<7,bt=o&ot^~o&st,vt=at+c+bt+ni[i]+s[i]&4294967295,h=e>>>2|e<<30,h^=e>>>13|e<<19,h^=e>>>22|e<<10,kt=e&y^e&p^y&p,dt=h+kt&4294967295,at=st,st=ot,ot=o,o=lt+vt&4294967295,lt=p,p=y,y=e,e=vt+dt&4294967295;w=w+e&4294967295;b=b+y&4294967295;k=k+p&4294967295;d=d+lt&4294967295;g=g+o&4294967295;nt=nt+ot&4294967295;tt=tt+st&4294967295;it=it+at&4294967295}for(f=ht(32),i=0;i<4;i++)f[i]=w>>>8*(3-i)&255,f[i+4]=b>>>8*(3-i)&255,f[i+8]=k>>>8*(3-i)&255,f[i+12]=d>>>8*(3-i)&255,f[i+16]=g>>>8*(3-i)&255,f[i+20]=nt>>>8*(3-i)&255,f[i+24]=tt>>>8*(3-i)&255,f[i+28]=it>>>8*(3-i)&255;if(t)return f;for(yt="",gt="00,01,02,03,04,05,06,07,08,09,0a,0b,0c,0d,0e,0f,10,11,12,13,14,15,16,17,18,19,1a,1b,1c,1d,1e,1f,20,21,22,23,24,25,26,27,28,29,2a,2b,2c,2d,2e,2f,30,31,32,33,34,35,36,37,38,39,3a,3b,3c,3d,3e,3f,40,41,42,43,44,45,46,47,48,49,4a,4b,4c,4d,4e,4f,50,51,52,53,54,55,56,57,58,59,5a,5b,5c,5d,5e,5f,60,61,62,63,64,65,66,67,68,69,6a,6b,6c,6d,6e,6f,70,71,72,73,74,75,76,77,78,79,7a,7b,7c,7d,7e,7f,80,81,82,83,84,85,86,87,88,89,8a,8b,8c,8d,8e,8f,90,91,92,93,94,95,96,97,98,99,9a,9b,9c,9d,9e,9f,a0,a1,a2,a3,a4,a5,a6,a7,a8,a9,aa,ab,ac,ad,ae,af,b0,b1,b2,b3,b4,b5,b6,b7,b8,b9,ba,bb,bc,bd,be,bf,c0,c1,c2,c3,c4,c5,c6,c7,c8,c9,ca,cb,cc,cd,ce,cf,d0,d1,d2,d3,d4,d5,d6,d7,d8,d9,da,db,dc,dd,de,df,e0,e1,e2,e3,e4,e5,e6,e7,e8,e9,ea,eb,ec,ed,ee,ef,f0,f1,f2,f3,f4,f5,f6,f7,f8,f9,fa,fb,fc,fd,fe,ff".split(","),i=0;i<f.length;i++)yt+=gt[f[i]];return yt};Base64.write=function(t,i){if(t===null)return"";if(t=String(t),t=r(t),i){for(var o=[],u=n,s=Base64.hash(i),h=u+u+u+u+u,f=0,e=0;f<t.length;f++,e=e===String(s).length-1?0:e+1)o[f]=h[parseInt(u.indexOf(t[f]))+parseInt(u.indexOf(String(s)[e]))*4];t="d"+o.join("");f=null;o=null;u=null;s=null;e=null;h=null;i=null}return t};Base64.read=function(t,i){if(t===null)return"";if(t=String(t),i&&/^d/.test(t)){t=t.replace(/^d/,"");for(var h=t.length,o=[],r=n,s=Base64.hash(i),c=r+r+r+r+r,l=String(s).length,a=r.length,e=0,f=0;e<h;e++,f=f===l-1?0:f+1)o[e]=c[r.indexOf(t[e])+a*4-parseInt(r.indexOf(String(s)[f]))*4];t=o.join("");i=null;h=null;o=null;r=null;s=null;f=null;c=null;e=null}return u(t)};Base64.write_and_verify=function(n,t){function r(n,t){var r,u,i;if(diff=[],d=1,t===null)return"Decompressing the string returned null. Possibly invalid key used??";for(r=n.length,u=t.length,diff[0]=r!==u?"Strings are not the same length. String 1: "+r+" characters. String 2: "+u+" characters.":"Entire text length: "+r+" characters",i=0;i<r&&i<u;i++)n.charAt(i)!==t.charAt(i)&&(diff[d]="Char "+(i+1)+": ASCII "+n.charCodeAt(i)+" not equal to ",diff[d]=diff[d]+"ASCII "+t.charCodeAt(i)+".",diff[d]=diff[d]+"Surrounding text: "+n.slice(i-10,i+10),d++);return d===1?!1:diff.join("<br />")}var i=n;return n=Base64.write(n,t),Base64.read(n,t)!==i?"Write error! Aborted operation. "+r(i,Base64.read(n,t)):n};Base64.createPublicKey=function(n){n=Base64.number_hash(n,100);return t("32416178251").modPow(n,i).toString()};Base64.getSessionKey=function(n,r){return t(r).modPow(Base64.number_hash(n,100),i).toString()};Base64.createUserKey=function(n,t){return Base64.write("key:"+t,Base64.getSessionKey(t,n))};Base64.createUserKey_and_verify=function(n,t){var r=Base64.createPublicKey(t),f=Base64.createPublicKey(n),e=Base64.getSessionKey(n,r),u=Base64.getSessionKey(t,f),i;if(e!==u)throw new Error("Public/Private key creation error");if(i=Base64.write_and_verify("key:"+t,u),String(t)===String(Base64.readUserKey(n,i,r)))return i;throw new Error("Error creating user key for "+n);};Base64.readUserKey=function(n,t,i){var r=Base64.read(t,Base64.getSessionKey(n,i));return/^key:/.test(r)?r.replace(/^key:/,""):!1};Base64.share=function(n,t,i,r){var f=Base64.rand(300),e=[Base64.createUserKey(Base64.createPublicKey(t),f)],u;if(r=!isNaN(parseFloat(r))&&isFinite(r)?(new Date).getTime()+r*26298e5:r?(new Date).getTime()+473364e5:!1,i=i&&i instanceof Array?i:null,i)for(u=0;u<i.length;u++)e[u+1]=Base64.createUserKey(i[u],f);return{Version:Base64.Version,Expires:r,Compressed:!0,Data:Base64.write(n,f),PublicKey:Base64.createPublicKey(f),UserKeys:Base64.write_and_verify(JSON.stringify(e)),Signature:Base64.hash(n+r)}};Base64.readShared=function(n,t){var e,s="debug",i="",f=null,o=null,r,u,h;if(n.Version===Base64.Version||n.Version===1){if(n.UserKeys&&n.Compressed){for(r=JSON&&JSON.parse(Base64.read(n.UserKeys))||$.parseJSON(Base64.read(n.UserKeys)),u=0,h=r.length;u<h;u++)Base64.readUserKey(t,r[u],n.PublicKey)&&(e=Base64.readUserKey(t,r[u],n.PublicKey));r=null}n.Expires!==!1&&(new Date).getTime()>n.Expires?i="data expired":e?(f=Base64.read(n.Data,e),o=Base64.hash(f+n.Expires),n.Signature===o?(s="results",i="success"):(f=null,i="hash didn't match")):i="no key match"}else i="file version '"+n.Version+"' not supported";return{type:s,message:i,data:f,hash:o}}})();