"use strict";
/*!
* Base64 performs several functions:
* Compress a string to base64, Diffie Hellman Merkle key exchange,
* SHA256 hash, and generate high entropy random numbers.
* Generated public Keys are numeric and 300 or 644 digits in length (~996 or 2140 bit equivelent).
*
* Last Modified: July 27, 2023
* Copyright (C) 2023 Graeme Goodkey github.com/ggoodkey
* All rights reserved
*
* Released free of charge for inclusion in your own applications, as is or as modified by you.
* DISTRIBUTED "AS IS", WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND.
*
* Converting to Base 64 is based on Vassilis Petroulias' base64v1_0.js
* http://jsbase64.codeplex.com/
*
* Compression is based on Sam Hocevar's lz-string-1.3.3.js
* http://pieroxy.net/blog/pages/lz-string/index.html
*
* Handling big integers is a subset of BigInteger.js by peterolson
* https://www.npmjs.com/package/big-integer/
*
*/
var bigInt=function(a){var y=1e7,l=7,r=9007199254740992,t=u(r),f="0123456789abcdefghijklmnopqrstuvwxyz";function h(e){return-r<e&&e<r}function u(e){return e<1e7?[e]:e<1e14?[e%1e7,Math.floor(e/1e7)]:[e%1e7,Math.floor(e/1e7)%1e7,Math.floor(e/1e14)]}function m(e){c(e);var r=e.length;if(r<4&&N(e,t)<0)switch(r){case 0:return 0;case 1:return e[0];case 2:return e[0]+e[1]*y;default:return e[0]+(e[1]+e[2]*y)*y}return e}function c(e){for(var r=e.length;0===e[--r];);e.length=r+1}function b(e){for(var r=new Array(e),t=-1;++t<e;)r[t]=0;return r}function p(e){return 0<e?Math.floor(e):Math.ceil(e)}function n(e,r){for(var t,n=e.length,i=r.length,o=new Array(n),a=0,s=y,u=0;u<i;u++)a=s<=(t=e[u]+r[u]+a)?1:0,o[u]=t-a*s;for(;u<n;)a=(t=e[u]+a)===s?1:0,o[u++]=t-a*s;return 0<a&&o.push(a),o}function g(e,r){return e.length>=r.length?n(e,r):n(r,e)}function i(e,r){for(var t,n=e.length,i=new Array(n),o=y,a=0;a<n;a++)t=e[a]-o+r,r=Math.floor(t/o),i[a]=t-r*o,r+=1;for(;0<r;)i[a++]=r%o,r=Math.floor(r/o);return i}function v(e,r){for(var t,n=e.length,i=r.length,o=new Array(n),a=0,s=y,u=0;u<i;u++)a=(t=e[u]-a-r[u])<0?(t+=s,1):0,o[u]=t;for(u=i;u<n;u++){if(!((t=e[u]-a)<0)){o[u++]=t;break}t+=s,o[u]=t}for(;u<n;u++)o[u]=e[u];return c(o),o}function o(e,r,t){for(var n,i=e.length,o=new Array(i),a=-r,s=y,u=0;u<i;u++)n=e[u]+a,a=Math.floor(n/s),n%=s,o[u]=n<0?n+s:n;return"number"==typeof(o=m(o))?(t&&(o=-o),new D(o)):new I(o,t)}function d(e,r){for(var t,n,i,o=e.length,a=r.length,s=b(o+a),u=y,l=0;l<o;++l){i=e[l];for(var h=0;h<a;++h)t=i*r[h]+s[l+h],n=Math.floor(t/u),s[l+h]=t-n*u,s[l+h+1]+=n}return c(s),s}function w(e,r){for(var t,n=e.length,i=new Array(n),o=y,a=0,s=0;s<n;s++)t=e[s]*r+a,a=Math.floor(t/o),i[s]=t-a*o;for(;0<a;)i[s++]=a%o,a=Math.floor(a/o);return i}function A(e,r){for(var t=[];0<r--;)t.push(0);return t.concat(e)}function s(e){for(var r,t,n,i=e.length,o=b(i+i),a=y,s=0;s<i;s++){t=0-(n=e[s])*n;for(var u=s;u<i;u++)r=n*e[u]*2+o[s+u]+t,t=Math.floor(r/a),o[s+u]=r-t*a;o[s+i]=t}return c(o),o}function S(e,r,t){return new I(e<y?w(r,e):d(r,u(e)),t)}function M(e,r){for(var t,n=e.length,i=b(n),o=y,a=0,s=n-1;0<=s;--s)a=(t=a*o+e[s])-(t=p(t/r))*r,i[s]=0|t;return[i,0|a]}function C(e,r){var t=P(r),n=e.value,i=t.value;if(0===i)throw new Error("Cannot divide by zero");if(e.isSmall)return t.isSmall?[new D(p(n/i)),new D(n%i)]:[U[0],e];if(t.isSmall){if(1===i)return[e,U[0]];if(-1==i)return[e.negate(),U[0]];var o=Math.abs(i);if(o<y){s=m((a=M(n,o))[0]);r=a[1];return e.sign&&(r=-r),"number"==typeof s?(e.sign!==t.sign&&(s=-s),[new D(s),new D(r)]):[new I(s,e.sign!==t.sign),new D(r)]}i=u(o)}o=N(n,i);if(-1===o)return[U[0],e];if(0===o)return[U[e.sign===t.sign?1:-1],U[0]];s=(a=(n.length+i.length<=200?function(e,r){var t,n,i,o,a,s,u,l=e.length,h=r.length,f=y,c=b(r.length),p=r[h-1],g=Math.ceil(f/(2*p)),v=w(e,g),d=w(r,g);for(v.length<=l&&v.push(0),d.push(0),p=d[h-1],n=l-h;0<=n;n--){for(t=f-1,v[n+h]!==p&&(t=Math.floor((v[n+h]*f+v[n+h-1])/p)),o=i=0,s=d.length,a=0;a<s;a++)i+=t*d[a],u=Math.floor(i/f),o+=v[n+a]-(i-u*f),i=u,o=o<0?(v[n+a]=o+f,-1):(v[n+a]=o,0);for(;0!==o;){for(--t,a=i=0;a<s;a++)i=(i+=v[n+a]-f+d[a])<0?(v[n+a]=i+f,0):(v[n+a]=i,1);o+=i}c[n]=t}return v=M(v,g)[0],[m(c),m(v)]}:function(e,r){for(var t,n,i,o,a,s=e.length,u=r.length,l=[],h=[],f=y;s;)if(h.unshift(e[--s]),c(h),N(h,r)<0)l.push(0);else{for(i=h[(n=h.length)-1]*f+h[n-2],o=r[u-1]*f+r[u-2],u<n&&(i=(i+1)*f),t=Math.ceil(i/o);!(N(a=w(r,t),h)<=0)&&--t;);l.push(t),h=v(h,a)}return l.reverse(),[m(l),m(h)]})(n,i))[0];var t=e.sign!==t.sign,a=a[1],e=e.sign,s="number"==typeof s?(t&&(s=-s),new D(s)):new I(s,t),e="number"==typeof a?(e&&(a=-a),new D(a)):new I(a,e);return[s,e]}function E(e,r,t){r=function(e,r){if((r=bigInt(r)).isZero()){if(e.isZero())return{value:[0],isNegative:!1};throw new Error("Cannot convert nonzero numbers to base 0.")}if(r.equals(-1)){if(e.isZero())return{value:[0],isNegative:!1};if(e.isNegative())return{value:[].concat.apply([],Array.apply(null,Array(-e.toJSNumber())).map(Array.prototype.valueOf,[1,0])),isNegative:!1};var t=Array.apply(null,Array(e.toJSNumber()-1)).map(Array.prototype.valueOf,[0,1]);return t.unshift([1]),{value:[].concat.apply([],t),isNegative:!1}}if(t=!1,e.isNegative()&&r.isPositive()&&(t=!0,e=e.abs()),r.isUnit())return e.isZero()?{value:[0],isNegative:!1}:{value:Array.apply(null,Array(e.toJSNumber())).map(Number.prototype.valueOf,1),isNegative:t};for(var n=[],i=e;i.isNegative()||0<=i.compareAbs(r);){i=(o=i.divmod(r)).quotient;var o=o.remainder;o.isNegative()&&(o=r.minus(o).abs(),i=i.next()),n.push(o.toJSNumber())}return n.push(i.toJSNumber()),{value:n.reverse(),isNegative:t}}(e,r);return(r.isNegative?"-":"")+r.value.map(function(e){return(r=e)<(e=(e=t)||f).length?e[r]:"<"+r+">";var r}).join("")}function N(e,r){if(e.length!==r.length)return e.length>r.length?1:-1;for(var t=e.length-1;0<=t;t--)if(e[t]!==r[t])return e[t]>r[t]?1:-1;return 0}function O(e){if(h(+e)){var r=+e;if(r===p(r))return new D(r);throw new Error("Invalid integer: "+e)}var t="-"===e[0];t&&(e=e.slice(1));var n=e.split(/e/i);if(2<n.length)throw new Error("Invalid integer: "+n.join("e"));if(2===n.length){var i=n[1];"+"===i[0]&&(i=i.slice(1));r=+i;if(r!==p(r)||!h(r))throw new Error("Invalid integer: "+r+" is not a valid exponent.");i=n[0],n=i.indexOf(".");if(0<=n&&(r-=i.length-n-1,i=i.slice(0,n)+i.slice(n+1)),r<0)throw new Error("Cannot include negative exponent part for integers");e=i+=new Array(r+1).join("0")}if(!/^([0-9][0-9]*)$/.test(e))throw new Error("Invalid integer: "+e);for(var o=[],a=e.length,s=l,u=a-s;0<a;)o.push(+e.slice(u,a)),(u-=s)<0&&(u=0),a-=s;return c(o),new I(o,t)}function P(e){return"number"==typeof e?function(e){if(h(e)){if(e!==p(e))throw new Error(e+" is not an integer.");return new D(e)}return O(e.toString())}(e):"string"==typeof e?O(e):e}var I=(x.prototype.add=function(e){var r=P(e);if(this.sign!==r.sign)return this.subtract(r.negate());var t=this.value,e=r.value;return r.isSmall?new x(i(t,Math.abs(e)),this.sign):new x(g(t,e),this.sign)},x.prototype.subtract=function(e){var r=P(e);if(this.sign!==r.sign)return this.add(r.negate());var t,n=this.value,e=r.value;return r.isSmall?o(n,Math.abs(e),this.sign):(r=n,n=e,e=this.sign,0<=N(r,n)?t=v(r,n):(t=v(n,r),e=!e),"number"==typeof(t=m(t))?(e&&(t=-t),new D(t)):new I(t,e))},x.prototype.negate=function(){return new x(this.value,!this.sign)},x.prototype.abs=function(){return new x(this.value,!1)},x.prototype.multiply=function(e){var r,t=P(e),n=this.value,i=t.value,e=this.sign!==t.sign;if(t.isSmall){if(0===i)return U[0];if(1===i)return this;if(-1===i)return this.negate();if((r=Math.abs(i))<y)return new x(w(n,r),e);i=u(r)}return t=n.length,r=i.length,new x((0<-.012*t-.012*r+15e-6*t*r?function e(r,t){var n=Math.max(r.length,t.length);if(n<=30)return d(r,t);n=Math.ceil(n/2);var i=r.slice(n),o=r.slice(0,n),a=t.slice(n),s=t.slice(0,n),r=e(o,s),t=e(i,a),a=e(g(o,i),g(s,a)),n=g(g(r,A(v(v(a,r),t),n)),A(t,2*n));return c(n),n}:d)(n,i),e)},x.prototype._multiplyBySmall=function(e){return 0===e.value?U[0]:1===e.value?this:-1===e.value?this.negate():S(Math.abs(e.value),this.value,this.sign!==e.sign)},x.prototype.square=function(){return new x(s(this.value),!1)},x.prototype.divmod=function(e){e=C(this,e);return{quotient:e[0],remainder:e[1]}},x.prototype.divide=function(e){return C(this,e)[0]},x.prototype.mod=function(e){return C(this,e)[1]},x.prototype.modPow=function(e,r){if(e=P(e),(r=P(r)).isZero())throw new Error("Cannot take modPow with modulus 0");for(var t=U[1],n=this.mod(r);e.isPositive();){if(n.isZero())return U[0];e.isOdd()&&(t=t.multiply(n).mod(r)),e=e.divide(2),n=n.square().mod(r)}return t},x.prototype.compareAbs=function(e){var r=P(e),t=this.value,e=r.value;return r.isSmall?1:N(t,e)},x.prototype.compare=function(e){if(e===1/0)return-1;if(e===-1/0)return 1;var r=P(e),t=this.value,e=r.value;return this.sign!==r.sign?r.sign?1:-1:r.isSmall?this.sign?-1:1:N(t,e)*(this.sign?-1:1)},x.prototype.equals=function(e){return 0===this.compare(e)},x.prototype.isOdd=function(){return 1==(1&this.value[0])},x.prototype.isPositive=function(){return!this.sign},x.prototype.isNegative=function(){return this.sign},x.prototype.isUnit=function(){return!1},x.prototype.isZero=function(){return!1},x.prototype.next=function(){var e=this.value;return this.sign?o(e,1,this.sign):new x(i(e,1),this.sign)},x.prototype.toString=function(e,r){if(e===a&&(e=10),10!==e)return E(this,e,r);for(var t,n=this.value,i=n.length,o=String(n[--i]);0<=--i;)t=String(n[i]),o+="0000000".slice(t.length)+t;return(this.sign?"-":"")+o},x.prototype.valueOf=function(){return parseInt(this.toString(),10)},x);function x(e,r){this.plus=this.add,this.minus=this.subtract,this.times=this.multiply,this.over=this.divide,this.remainder=this.mod,this.compareTo=this.compare,this.eq=this.equals,this.toJSNumber=this.valueOf,this.value=e,this.sign=r,this.isSmall=!1}var D=(R.prototype.add=function(e){var r=P(e),t=this.value;if(t<0!==r.sign)return this.subtract(r.negate());e=r.value;if(r.isSmall){if(h(t+e))return new R(t+e);e=u(Math.abs(e))}return new I(i(e,Math.abs(t)),t<0)},R.prototype.subtract=function(e){var r=P(e),t=this.value;if(t<0!==r.sign)return this.add(r.negate());e=r.value;return r.isSmall?new R(t-e):o(e,Math.abs(t),0<=t)},R.prototype.compareAbs=function(e){var r=P(e),t=Math.abs(this.value),e=r.value;return r.isSmall?t===(e=Math.abs(e))?0:e<t?1:-1:-1},R.prototype.compare=function(e){if(e===1/0)return-1;if(e===-1/0)return 1;var r=P(e),t=this.value,e=r.value;return r.isSmall?t==e?0:e<t?1:-1:t<0!==r.sign?t<0?-1:1:t<0?1:-1},R.prototype.negate=function(){var e=this.sign,r=new R(-this.value);return r.sign=!e,r},R.prototype.abs=function(){return new R(Math.abs(this.value))},R.prototype._multiplyBySmall=function(e){return h(e.value*this.value)?new R(e.value*this.value):S(Math.abs(e.value),u(Math.abs(this.value)),this.sign!==e.sign)},R.prototype.multiply=function(e){return P(e)._multiplyBySmall(this)},R.prototype.square=function(){var e=this.value*this.value;return h(e)?new R(e):new I(s(u(Math.abs(this.value))),!1)},R.prototype.isOdd=function(){return 1==(1&this.value)},R.prototype.isPositive=function(){return 0<this.value},R.prototype.isNegative=function(){return this.value<0},R.prototype.isUnit=function(){return 1===Math.abs(this.value)},R.prototype.isZero=function(){return 0===this.value},R.prototype.next=function(){var e=this.value;return e+1<r?new R(e+1):new I(t,!1)},R.prototype.toString=function(e,r){return e===a&&(e=10),10!=e?E(this,e,r):String(this.value)},R.prototype.valueOf=function(){return this.value},R.prototype.modPow=function(e,r){if(e=P(e),(r=P(r)).isZero())throw new Error("Cannot take modPow with modulus 0");for(var t=U[1],n=this.mod(r);e.isPositive();){if(n.isZero())return U[0];e.isOdd()&&(t=t.multiply(n).mod(r)),e=e.divide(2),n=n.square().mod(r)}return t},R.prototype.equals=function(e){return 0===this.compare(e)},R.prototype.divmod=function(e){e=C(this,e);return{quotient:e[0],remainder:e[1]}},R.prototype.divide=function(e){return C(this,e)[0]},R.prototype.mod=function(e){return C(this,e)[1]},R);function R(e){this.plus=this.add,this.minus=this.subtract,this.compareTo=this.compare,this.times=this.multiply,this.toJSNumber=this.valueOf,this.eq=this.equals,this.over=this.divide,this.remainder=this.mod,this.value=e,this.sign=e<0,this.isSmall=!0}for(var U=[],e=0;e<1e3;e++)U[e]=P(e),0<e&&(U[-e]=P(-e));return function(e,r,t,n){return void 0===e?U[0]:void 0!==r&&(10!=+r||t)?function(e,r,t,n){t=t||f,e=String(e),n||(e=e.toLowerCase(),t=t.toLowerCase());for(var i=e.length,o=Math.abs(r),a={},s=0;s<t.length;s++)a[t[s]]=s;for(s=0;s<i;s++){var u=e[s];if("-"!==u&&(u in a&&a[u]>=o&&("1"!==u||1!==o)))throw new Error(u+" is not a valid digit in base "+r+".")}var l=[],n="-"===e[0];for(s=n?1:0;s<e.length;s++)if((u=e[s])in a)l.push(P(a[u]));else{if("<"!==u)throw new Error(u+" is not a valid character");for(var h=s;s++,">"!==e[s]&&s<e.length;);l.push(P(e.slice(h+1,s)))}return function(e,r,t){for(var n=U[0],i=U[1],o=e.length-1;0<=o;o--)n=n.add(e[o].times(i)),i=i.times(r);return t?n.negate():n}(l,P(r),n)}(e,r,t,n):P(e)}}(),Base64=function(){var f={Version:1.3,Mode:"normal"},c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",e=/[^A-Za-z0-9\+\/\=]/g,p="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_~",i="00,01,02,03,04,05,06,07,08,09,0a,0b,0c,0d,0e,0f,10,11,12,13,14,15,16,17,18,19,1a,1b,1c,1d,1e,1f,20,21,22,23,24,25,26,27,28,29,2a,2b,2c,2d,2e,2f,30,31,32,33,34,35,36,37,38,39,3a,3b,3c,3d,3e,3f,40,41,42,43,44,45,46,47,48,49,4a,4b,4c,4d,4e,4f,50,51,52,53,54,55,56,57,58,59,5a,5b,5c,5d,5e,5f,60,61,62,63,64,65,66,67,68,69,6a,6b,6c,6d,6e,6f,70,71,72,73,74,75,76,77,78,79,7a,7b,7c,7d,7e,7f,80,81,82,83,84,85,86,87,88,89,8a,8b,8c,8d,8e,8f,90,91,92,93,94,95,96,97,98,99,9a,9b,9c,9d,9e,9f,a0,a1,a2,a3,a4,a5,a6,a7,a8,a9,aa,ab,ac,ad,ae,af,b0,b1,b2,b3,b4,b5,b6,b7,b8,b9,ba,bb,bc,bd,be,bf,c0,c1,c2,c3,c4,c5,c6,c7,c8,c9,ca,cb,cc,cd,ce,cf,d0,d1,d2,d3,d4,d5,d6,d7,d8,d9,da,db,dc,dd,de,df,e0,e1,e2,e3,e4,e5,e6,e7,e8,e9,ea,eb,ec,ed,ee,ef,f0,f1,f2,f3,f4,f5,f6,f7,f8,f9,fa,fb,fc,fd,fe,ff".split(","),r="319705304701141539155720137200974664666792526059405792539680974929469783512821793995613718943171723765238853752439032835985158829038528214925658918372196742089464683960239919950882355844766055365179937610326127675178857306260955550407044463370239890187189750909036833976197804646589380690779463976173",P={b:{CODE:"b",NAME:"normal",CHARSET:c,PRIME:r,VALIDATION:e},u:{CODE:"u",NAME:"urlsafe",CHARSET:p,PRIME:r,VALIDATION:/[^A-Za-z0-9\-_~]/g},p:{CODE:"p",NAME:"performance",CHARSET:c,PRIME:r,COMPRESS:!1,VALIDATION:e},s:{CODE:"s",NAME:"security",CHARSET:c,PRIME:"1475979915214180235084898622737381736312066145333169775147771216478570297878078949377407337049389289382748507531496480477281264838760259191814463365330269540496961201113430156902396093989090226259326935025281409614983499388222831448598601834318536230923772641390209490231836446899608210795482963763094236630945410832793769905399982457186322944729636418890623372171723742105636440368218459649632948538696905872650486914434637457507280441823676813517852099348660847172579408422316678097670224011990280170474894487426924742108823536808485072502240519452587542875349976558572670229633962575212637477897785501552646522609988869914013540483809865681250419497686697771007",COMPRESS:!0,VALIDATION:e}},I="b";function o(e){for(var r="",t=0,n=e.length;t<n;t++)r+=i[e[t]];return r}function a(e){for(var r=1779033703,t=3144134277,n=1013904242,i=2773480762,o=1359893119,a=2600822924,s=528734635,u=1541459225,l=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],h=unescape(encodeURIComponent(e)),f=new Uint8Array(h.length),c=0;c<h.length;c++)f[c]=255&h.charCodeAt(c);var p=f.length,g=64*Math.floor((p+72)/64),v=g/4,e=8*p,d=new Uint8Array(g);if("undefined"==typeof Uint8Array||Array.isArray(d)){for(c=0;c<f.length;c++)d[c]=f[c];for(c=f.length;c<d.length;c++)d[c]=0}else d.set(f);d[p]=128,d[g-4]=e>>>24,d[g-3]=e>>>16&255,d[g-2]=e>>>8&255,d[g-1]=255&e;var y,m=new Int32Array(v),b=0;for(c=0;c<m.length;c++)y=d[b]<<24,y|=d[b+1]<<16,y|=d[b+2]<<8,y|=d[b+3],m[c]=y,b+=4;b=y=null;for(var w,A,S,M,C,E,N,O,P,I,x,D,R,U=new Int32Array(64),k=0;k<v;k+=16){for(c=0;c<16;c++)U[c]=m[k+c];for(c=16;c<64;c++)A=(w=U[c-15])>>>7|w<<25,A^=w>>>18|w<<14,A^=w>>>3,S=(w=U[c-2])>>>17|w<<15,S^=w>>>19|w<<13,S^=w>>>10,U[c]=U[c-16]+A+U[c-7]+S&4294967295;for(M=r,C=t,E=n,N=i,O=o,P=a,I=s,x=u,c=0;c<64;c++)S=O>>>6|O<<26,S^=O>>>11|O<<21,D=x+(S^=O>>>25|O<<7)+(O&P^~O&I)+l[c]+U[c]&4294967295,A=M>>>2|M<<30,A^=M>>>13|M<<19,R=M&C^M&E^C&E,x=I,I=P,P=O,O=N+D&4294967295,N=E,E=C,M=D+((A^=(C=M)>>>22|M<<10)+R&4294967295)&4294967295;r=r+M&4294967295,t=t+C&4294967295,n=n+E&4294967295,i=i+N&4294967295,o=o+O&4294967295,a=a+P&4294967295,s=s+I&4294967295,u=u+x&4294967295}var K=new Uint8Array(32);for(c=0;c<4;c++)K[c]=r>>>8*(3-c)&255,K[c+4]=t>>>8*(3-c)&255,K[c+8]=n>>>8*(3-c)&255,K[c+12]=i>>>8*(3-c)&255,K[c+16]=o>>>8*(3-c)&255,K[c+20]=a>>>8*(3-c)&255,K[c+24]=s>>>8*(3-c)&255,K[c+28]=u>>>8*(3-c)&255;return K}function s(e,r){return bigInt(r).modPow(f.number_hash(e,100),P[I].PRIME).toString()}return f.setMode=function(e){switch(e){case P.s.NAME:I="s",f.Mode=e;break;case P.p.NAME:I="p",f.Mode=e;break;case P.u.NAME:I="u",f.Mode=e;break;case P.b.NAME:default:I="b",f.Mode=P.b.NAME}},f.atob=function(e){var o=null;if(e.length%4)throw new Error("InvalidCharacterError: 'Base64.atob' failed: The string to be decoded is not correctly encoded.");for(var r=function(e){var r,t=-1,n=[],i=[0,0,0,0];if(!o){for(r=c.length,o={};++t<r;)o[c.charAt(t)]=t;t=-1}for(r=e.length;++t<r&&(i[0]=o[e.charAt(t)],i[1]=o[e.charAt(++t)],n.push(i[0]<<2|i[1]>>4),i[2]=o[e.charAt(++t)],64!==i[2])&&(n.push((15&i[1])<<4|i[2]>>2),i[3]=o[e.charAt(++t)],64!==i[3]);)n.push((3&i[2])<<6|i[3]);return n}(e),t=0,n=r.length,i="";t<n;)r[t]<128?i+=String.fromCharCode(r[t++]):191<r[t]&&r[t]<224?i+=String.fromCharCode((31&r[t++])<<6|63&r[t++]):i+=String.fromCharCode((15&r[t++])<<12|(63&r[t++])<<6|63&r[t++]);return i},f.btoa=function(e){for(var r,t,n=function(e){var r,t=-1,n=e.length,i=[];if(/^[\x00-\x7f]*$/.test(e))for(;++t<n;)i.push(e.charCodeAt(t));else for(;++t<n;)(r=e.charCodeAt(t))<128?i.push(r):r<2048?i.push(r>>6|192,63&r|128):i.push(r>>12|224,r>>6&63|128,63&r|128);return i}(e),i=-1,o=n.length,a=[0,0,0,0],s="";++i<o;)t=n[i],r=n[++i],a[0]=t>>2,a[1]=(3&t)<<4|r>>4,isNaN(r)?a[2]=a[3]=64:(t=n[++i],a[2]=(15&r)<<2|t>>6,a[3]=isNaN(t)?64:63&t),s+=c[a[0]]+c[a[1]]+c[a[2]]+c[a[3]];return s},f.number_hash=function(e,r){r=r&&!isNaN(r)&&isFinite(r)&&0<r?r:10;for(var t,n="",i=0,o="",a=void 0;n.length<r;0){for(a=0,t=e.length;a<t;a++)i=(i<<5)-i+e.charCodeAt(a),i|=0;for(o=String(i+Math.pow(2,31));o.length<10;)o="0"+i;n+=o.slice(2)}return n.slice(0,r)},f.rand=function(e,r){function t(){return String(Math.floor(Math.random()*(Math.pow(10,16)-1-Math.pow(10,15)+1)+Math.pow(10,15))).slice(3,15)}var n=e&&!isNaN(e)&&isFinite(e)&&0<e?e:8,i=r?String(r):t(),o=0,a="",s="";for(300<n&&(n=300);s.length<n;){o=Number(t());for(var u=0;u<4300;u++)o+=Number(String((new Date).getTime()).slice(7));for(a=String(o);"0"===a.charAt(0)&&1<a.length;)a=a.slice(1);s+=a=f.number_hash(i+a,8)}for(;"0"===s.charAt(0)&&1<s.length;)s=s.slice(1);return s.length<n?f.rand(n,i+t()):s.slice(0,n)},f.hash=function(e,r){return e=e||"",o(a(e=r?String(r)+String(e):String(e.length+1231)+String(e)))},f.hmac=function(e,r){if(32<(r=String(r)).length)n=a(r);else for(var t=unescape(encodeURIComponent(r)),n=new Uint8Array(32),i=0;i<t.length;i++)n[i]=t.charCodeAt(i);for(i=0;i<n.length;i++)n[i]^=54;for(r=o(a(o(n))),i=0;i<n.length;i++)n[i]^=106;return f.hash(String(e),o(n)+r)},f.write=function(e,r){if(null==e)return"";if(e=function(e){function r(e){for(var r=0;r<2*e.length;)r%2==0?(t=e.charCodeAt(r/2)>>8,n=255&e.charCodeAt(r/2),i=r/2+1<e.length?e.charCodeAt(r/2+1)>>8:NaN):(t=255&e.charCodeAt((r-1)/2),(r+1)/2<e.length?(n=e.charCodeAt((r+1)/2)>>8,i=255&e.charCodeAt((r+1)/2)):n=i=NaN),r+=3,o=t>>2,a=(3&t)<<4|n>>4,s=(15&n)<<2|i>>6,u=63&i,isNaN(n)?s=u=64:isNaN(i)&&(u=64),p=p+N.charAt(o)+N.charAt(a)+N.charAt(s)+N.charAt(u);return p}if(null===e)return"";if(!1===P[I].COMPRESS)return P[I].CODE+r("n"+e);for(var t,n,i,o,a,s,u,l,h,f,c,p="",g=e,v={},d={},y="",m=2,b=3,w=2,A="",S=0,M=0,C=String.fromCharCode,E=0;E<e.length;E+=1)if(f=e.charAt(E),Object.prototype.hasOwnProperty.call(v,f)||(v[f]=b++,d[f]=!0),c=y+f,Object.prototype.hasOwnProperty.call(v,c))y=c;else{if(Object.prototype.hasOwnProperty.call(d,y)){if(y.charCodeAt(0)<256){for(l=0;l<w;l++)S<<=1,15===M?(M=0,A+=C(S),S=0):M++;for(h=y.charCodeAt(0),l=0;l<8;l++)S=S<<1|1&h,15===M?(M=0,A+=C(S),S=0):M++,h>>=1}else{for(h=1,l=0;l<w;l++)S=S<<1|h,15===M?(M=0,A+=C(S),S=0):M++,h=0;for(h=y.charCodeAt(0),l=0;l<16;l++)S=S<<1|1&h,15===M?(M=0,A+=C(S),S=0):M++,h>>=1}0===--m&&(m=Math.pow(2,w),w++),delete d[y]}else for(h=v[y],l=0;l<w;l++)S=S<<1|1&h,15===M?(M=0,A+=C(S),S=0):M++,h>>=1;0===--m&&(m=Math.pow(2,w),w++),v[c]=b++,y=String(f)}if(""!==y){if(Object.prototype.hasOwnProperty.call(d,y)){if(y.charCodeAt(0)<256){for(l=0;l<w;l++)S<<=1,15===M?(M=0,A+=C(S),S=0):M++;for(h=y.charCodeAt(0),l=0;l<8;l++)S=S<<1|1&h,15===M?(M=0,A+=C(S),S=0):M++,h>>=1}else{for(h=1,l=0;l<w;l++)S=S<<1|h,15===M?(M=0,A+=C(S),S=0):M++,h=0;for(h=y.charCodeAt(0),l=0;l<16;l++)S=S<<1|1&h,15===M?(M=0,A+=C(S),S=0):M++,h>>=1}0===--m&&(m=Math.pow(2,w),w++),delete d[y]}else for(h=v[y],l=0;l<w;l++)S=S<<1|1&h,15===M?(M=0,A+=C(S),S=0):M++,h>>=1;0===--m&&(m=Math.pow(2,w),w++)}for(h=2,l=0;l<w;l++)S=S<<1|1&h,15===M?(M=0,A+=C(S),S=0):M++,h>>=1;for(;;){if(S<<=1,15===M){A+=C(S);break}M++}var N=P[I].CHARSET,O=r("l"+A);return!0===P[I].COMPRESS||(g=r("n"+g),O.length>g.length&&(O=g)),P[I].CODE+O}(e=String(e)),r){for(var t=[],n=P[I].CHARSET,i=f.hash(r),o=n+n+n+n+n,a=0,s=0;a<e.length;a++,s=s===String(i).length-1?0:s+1)t[a]=o[n.indexOf(e[a])+4*n.indexOf(String(i)[s])];e="e"+P[I].CODE+t.join(""),r=o=s=i=n=t=a=null}return e},f.read=function(e,r){if(null==e)return"";if(e=String(e),r&&/^(d|e)/.test(e)){for(var t=/^eu/.test(e)?p:c,n=(e=e.replace(/^(d|eb|eu|ep|es)/,"")).length,i=[],o=f.hash(r),a=t+t+t+t+t,s=String(o).length,u=t.length,l=0,h=0;l<n;l++,h=h===s-1?0:h+1)i[l]=a[t.indexOf(e[l])+4*u-4*t.indexOf(String(o)[h])];e=i.join(""),l=a=h=o=t=i=n=r=null}return function(e){if(null===e)return console.log("Decompression error1: Input is null"),"";var r=e.charAt(0);if(!P[r])return null;var t=P[r].CHARSET;e=e.slice(1);var n,i,o,a,s,u,l="",h=0,f=0,c=0,p=String.fromCharCode;for(e=e.replace(P[r].VALIDATION,"");c<e.length;)n=t.indexOf(e.charAt(c++))<<2|(a=t.indexOf(e.charAt(c++)))>>4,i=(15&a)<<4|(s=t.indexOf(e.charAt(c++)))>>2,o=(3&s)<<6|(u=t.indexOf(e.charAt(c++))),h%2==0?(f=n<<8,64!==s&&(l+=p(f|i)),64!==u&&(f=o<<8)):(l+=p(f|n),64!==s&&(f=i<<8),64!==u&&(l+=p(f|o))),h+=3;if(u=s=a=o=i=n=f=h=null,!/^l/.test(l))return l.replace(/^n/,"");if(r=l.replace(/^l/,""),(l=null)===r)return console.log("Decompression error2: Reverted from Base64 value is null"),null;if(""===r)return console.log('Decompression error3: Reverted from Base64 value is "" (Empty string)'),null;for(var g,v,d,y=[0,1,2,3],m=4,b=4,w=3,A="",S="",M=0,C=4,E=1,N={string:r,val:r.charCodeAt(0),position:32768,index:1};E!=C;)v=N.val&N.position,N.position>>=1,0===N.position&&(N.position=32768,N.val=N.string.charCodeAt(N.index++)),M|=(0<v?1:0)*E,E<<=1;switch(M){case 0:for(M=0,C=Math.pow(2,8),E=1;E!=C;)v=N.val&N.position,N.position>>=1,0===N.position&&(N.position=32768,N.val=N.string.charCodeAt(N.index++)),M|=(0<v?1:0)*E,E<<=1;d=p(M);break;case 1:for(M=0,C=Math.pow(2,16),E=1;E!=C;)v=N.val&N.position,N.position>>=1,0===N.position&&(N.position=32768,N.val=N.string.charCodeAt(N.index++)),M|=(0<v?1:0)*E,E<<=1;d=p(M);break;case 2:return""}for(g=S=y[3]=d;;){if(N.index>N.string.length)return console.log("Decompression error5"),"";for(M=0,C=Math.pow(2,w),E=1;E!=C;)v=N.val&N.position,N.position>>=1,0===N.position&&(N.position=32768,N.val=N.string.charCodeAt(N.index++)),M|=(0<v?1:0)*E,E<<=1;switch(d=M){case 0:for(M=0,C=Math.pow(2,8),E=1;E!=C;)v=N.val&N.position,N.position>>=1,0===N.position&&(N.position=32768,N.val=N.string.charCodeAt(N.index++)),M|=(0<v?1:0)*E,E<<=1;y[b++]=p(M),d=b-1,m--;break;case 1:for(M=0,C=Math.pow(2,16),E=1;E!=C;)v=N.val&N.position,N.position>>=1,0===N.position&&(N.position=32768,N.val=N.string.charCodeAt(N.index++)),M|=(0<v?1:0)*E,E<<=1;y[b++]=p(M),d=b-1,m--;break;case 2:return S}if(0===m&&(m=Math.pow(2,w),w++),y[d])A=y[d];else{if(d!==b||!g)return null;A=g+g.charAt(0)}S+=A,y[b++]=g+A.charAt(0),g=A,0===--m&&(m=Math.pow(2,w),w++)}}(e)},f.write_and_verify=function(e,r){var t=e;return e=f.write(e,r),f.read(e,r)!==t?"Write error! Aborted operation. "+function(e,r){var t=[],n=1;if(null===r)return"Decompressing the string returned null. Possibly invalid key used??";var i=e.length,o=r.length;t[0]=i!==o?"Strings are not the same length. String 1: "+i+" characters. String 2: "+o+" characters.":"Entire text length: "+i+" characters";for(var a=0;a<i&&a<o;a++)e.charAt(a)!==r.charAt(a)&&(t[n]="Char "+(a+1)+": ASCII "+e.charCodeAt(a)+" not equal to ",t[n]=t[n]+"ASCII "+r.charCodeAt(a)+".",t[n]=t[n]+"Surrounding text: "+e.slice(a-10,a+10),n++);return 1!==n&&t.join("<br />")}(t,f.read(e,r)):e},f.createPublicKey=function(e){return e=f.number_hash(e,100),bigInt("32416178251").modPow(e,P[I].PRIME).toString()},f.createUserKey=function(e,r){return f.write("key:"+r,s(r,e))},f.createUserKey_and_verify=function(e,r){var t=f.createPublicKey(r),n=f.createPublicKey(e),i=s(e,t),n=s(r,n);if(i!==n)throw new Error("Public/Private key creation error");n=f.write_and_verify("key:"+r,n);if(String(r)===String(f.readUserKey(e,n,t)))return n;throw new Error("Error creating user key for "+e)},f.readUserKey=function(e,r,t){t=f.read(r,s(e,t));return!!/^key:/.test(t)&&t.replace(/^key:/,"")},f.share=function(e,r,t,n){var i=f.rand(P[I].PRIME.length),o=[f.createUserKey(f.createPublicKey(r),i)];if(n=n&&!isNaN(n)&&isFinite(n)?(new Date).getTime()+26298e5*n:!!n&&(new Date).getTime()+473364e5,e=f.write(e,i),t&&t instanceof Array)for(var a=0;a<t.length;a++)o[a+1]=f.createUserKey(t[a],i);return{Version:f.Version,Expires:n,Mode:P[I].NAME,Data:e,PublicKey:f.createPublicKey(i),UserKeys:f.write_and_verify(JSON.stringify(o)),Signature:f.hmac(e+n,i)}},f.readShared=function(e,r){var t,n,i,o="error",a="";if(e.Version===f.Version||1===e.Version||1.2===e.Version){if(e.UserKeys){for(var s=JSON.parse(f.read(e.UserKeys)),u=0,l=s.length;u<l;u++)f.readUserKey(r,s[u],e.PublicKey)&&(t=f.readUserKey(r,s[u],e.PublicKey));s=null}a=!1!==e.Expires&&(new Date).getTime()>e.Expires?"data expired":t?1===e.Version?(n=f.read(e.Data,t),i=f.hash(n+e.Expires),e.Signature===i?(o="results","success"):(n=null,"hash didn't match")):(i=f.hmac(e.Data+e.Expires,t),e.Signature===i?(n=f.read(e.Data,t),o="results","success"):(n=null,"hmac didn't match")):"no key match"}else a="file version '"+e.Version+"' not supported";return{type:o,message:a,data:n,hmac:i}},f}();